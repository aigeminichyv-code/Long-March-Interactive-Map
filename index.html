<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>äºŒè¬äº”åƒé‡Œé•·å¾ - äº¤äº’å¼æ•™å­¸åœ°åœ–</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <!-- Babel for in-browser compilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      :root {
        --paper-bg: #fdfbf7;
        --ink-color: #2c2420;
      }
      body {
        font-family: system-ui, -apple-system, serif;
        background-color: #f5f0e1;
        color: var(--ink-color);
        margin: 0;
        overflow: hidden;
      }
      .font-serif {
        font-family: "Songti SC", "SimSun", "Times New Roman", serif;
      }
      /* Custom Scrollbar */
      ::-webkit-scrollbar { width: 6px; height: 6px; }
      ::-webkit-scrollbar-track { background: #e6e2d3; }
      ::-webkit-scrollbar-thumb { background: #bcaaa4; border-radius: 3px; }
      ::-webkit-scrollbar-thumb:hover { background: #8d6e63; }
      
      /* Leaflet Customization */
      .leaflet-container {
        background: #e0e0e0;
        z-index: 0;
      }
      .custom-div-icon {
        background: transparent;
        border: none;
      }
      .marker-pin {
        width: 24px; height: 24px;
        border-radius: 50%;
        background: #b71c1c;
        border: 2px solid white;
        box-shadow: 0 2px 5px rgba(0,0,0,0.5);
        display: flex; align-items: center; justify-content: center;
        color: white; font-weight: bold; font-size: 12px;
        transition: transform 0.2s;
      }
      .marker-pin.active {
        background: #ffd600;
        border-color: #b71c1c;
        color: #b71c1c;
        transform: scale(1.3);
        z-index: 1000;
      }
      
      /* Animation Utilities */
      @keyframes fadeInZoom {
        from { opacity: 0; transform: scale(0.95); }
        to { opacity: 1; transform: scale(1); }
      }
      .animate-fade-in-zoom { animation: fadeInZoom 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
      
      .leaflet-pane { z-index: 10; }
      .leaflet-bottom, .leaflet-top { z-index: 40; }
    </style>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "lucide-react": "https://esm.sh/lucide-react@0.263.1",
    "leaflet": "https://esm.sh/leaflet@1.9.4",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
  <body>
    <div id="root"></div>
    <script type="text/babel" data-type="module" data-presets="react,typescript">
import React, { useState, useEffect, useRef } from 'react';
import { createRoot } from 'react-dom/client';
import { 
  Star, Trophy, Info, ChevronLeft, ChevronRight, MapPin, Users, BookOpen, Tent, 
  HelpCircle, Flag, Music, ScrollText, Flame, X, CheckCircle, XCircle, RefreshCw, 
  Wheat, Heart, AlertTriangle, ArrowRight, Skull, Medal, Scroll 
} from 'lucide-react';
import * as L from 'leaflet';

// --- TYPES ---

interface HistoricalFigure {
  name: string;
  role: string;
  desc: string;
}

interface QuizOption {
  label: string;
  // Index of correct option
}

interface Quiz {
  question: string;
  options: string[];
  answer: number;
  explanation: string;
}

interface GameOption {
  label: string;
  foodChange: number;
  moraleChange: number;
  result: string;
}

interface SurvivalChallenge {
  scenario: string;
  options: GameOption[];
}

interface Milestone {
  id: number;
  title: string;
  date: string;
  location: string;
  coords: [number, number];
  description: string;
  significance: string;
  figures: HistoricalFigure[];
  survival: {
    title: string;
    content: string;
    poem?: {
      text: string;
      author?: string;
      source?: string;
    };
  };
  stat: {
    label: string;
    value: string;
    icon: 'users' | 'info';
  };
  quizzes: Quiz[];
  game: SurvivalChallenge;
}

// --- CONSTANTS ---

const MILESTONES: Milestone[] = [
  {
    id: 0,
    title: "ç‘é‡‘å‡ºç™¼",
    date: "1934å¹´10æœˆ",
    location: "æ±Ÿè¥¿ç‘é‡‘",
    coords: [25.8846, 116.0275],
    description: "ç”±æ–¼ç¬¬äº”æ¬¡åã€Œåœå‰¿ã€å¤±æ•—ï¼Œä¸­å¤®ç´…è»ï¼ˆç´…ä¸€æ–¹é¢è»ï¼‰ä¸»åŠ›é–‹å§‹é€²è¡Œæˆ°ç•¥è½‰ç§»ã€‚é€™æ˜¯ä¸€æ¬¡è¢«é€¼ç„¡å¥ˆçš„æ’¤é€€ï¼ŒåˆæœŸæ”œå¸¶äº†å¤§é‡è¼œé‡ï¼ˆå£‡å£‡ç½ç½ï¼‰ï¼Œè¡Œè»é€Ÿåº¦æ¥µæ…¢ã€‚",
    significance: "ç´…è»è¢«è¿«æ’¤é›¢ä¸­å¤®è˜‡å€ï¼Œé–‹å§‹äº†è‰±è‹¦å“çµ•çš„æˆ°ç•¥å¤§è½‰ç§»ã€‚é€™æ˜¯é•·å¾çš„èµ·é»ã€‚",
    figures: [
      { name: "åšå¤", role: "ä¸­å…±ä¸­å¤®ç¸½è² è²¬äºº", desc: "æ™‚ä»»ä¸­å…±ä¸­å¤®ç¸½è² è²¬äººï¼Œæ¨è¡Œã€Œå·¦ã€å‚¾å†’éšªä¸»ç¾©ï¼Œå°è‡´ååœå‰¿å¤±æ•—ï¼Œé•·å¾åˆæœŸä»å …æŒéŒ¯èª¤æŒ‡æ®ã€‚" },
      { name: "æå¾·", role: "å…±ç”¢åœ‹éš›è»äº‹é¡§å•", desc: "å¾·åœ‹äººï¼ŒæŒæ¡ç´…è»æœ€é«˜è»äº‹æŒ‡æ®æ¬Šã€‚ä»–ä¸äº†è§£ä¸­åœ‹å¯¦éš›æƒ…æ³ï¼ŒæŒ‡æ®æ©Ÿæ¢°ï¼Œå°è‡´ç´…è»é­å—é‡å¤§æå¤±ã€‚" },
      { name: "å‘¨æ©ä¾†", role: "ç´…è»ç¸½æ”¿å§”", desc: "åœ¨æ¥µå…¶å›°é›£çš„æƒ…æ³ä¸‹è² è²¬å…·é«”è»äº‹çµ„ç¹”å·¥ä½œï¼ŒåŠªåŠ›æ¸›å°‘éŒ¯èª¤æŒ‡æ®å¸¶ä¾†çš„æå¤±ã€‚" }
    ],
    survival: {
      title: "æ¬å®¶å¼è¡Œè»",
      content: "å‡ºç™¼åˆæœŸï¼Œç´…è»å¯¦è¡Œã€Œå¤§æ¬å®¶ã€ï¼Œæ”œå¸¶äº†å°åˆ·æ©Ÿã€Xå…‰æ©Ÿç”šè‡³æ¡Œæ¤…æ¿å‡³ã€‚é€™äº›ç¬¨é‡çš„è¼œé‡åš´é‡æ‹–æ…¢äº†è¡Œè»é€Ÿåº¦ï¼Œè®“ç´…è»åœ¨çªç ´å°é–ç·šæ™‚ä»˜å‡ºäº†æ¥µå¤§ä»£åƒ¹ã€‚",
      poem: {
        text: "åæœˆé‡Œä¾†ç§‹é¢¨æ¶¼ï¼Œä¸­å¤®ç´…è»é å¾å¿™ã€‚æ˜Ÿå¤œæ¸¡éäºéƒ½æ²³ï¼Œå¤é™‚æ–°ç”°æ‰“å‹ä»—ã€‚",
        source: "æ±Ÿè¥¿æ°‘æ­Œ",
        author: "ä½šå"
      }
    },
    stat: { label: "å‡ºç™¼äººæ•¸", value: "8.6è¬é¤˜äºº", icon: "users" },
    quizzes: [
      { question: "é•·å¾çš„å‡ºç™¼é»ä¸»è¦æ˜¯åœ¨å“ªå€‹çœä»½ï¼Ÿ", options: ["é™è¥¿", "æ±Ÿè¥¿", "è²´å·", "å››å·"], answer: 1, explanation: "ä¸­å¤®ç´…è»æ˜¯å¾æ±Ÿè¥¿ç‘é‡‘ï¼ˆä¸­å¤®è˜‡å€ï¼‰å‡ºç™¼çš„ã€‚" },
      { question: "å°è‡´ç´…è»è¢«è¿«é€²è¡Œæˆ°ç•¥è½‰ç§»çš„ç›´æ¥åŸå› æ˜¯ï¼Ÿ", options: ["ç¬¬å››æ¬¡ååœå‰¿å¤±æ•—", "ç¬¬äº”æ¬¡ååœå‰¿å¤±æ•—", "åŒ—ä¸ŠæŠ—æ—¥", "æ“´å¤§æ ¹æ“šåœ°"], answer: 1, explanation: "ç¬¬äº”æ¬¡ååœå‰¿å¤±æ•—å¾Œï¼Œä¸­å¤®ç´…è»ç„¡æ³•åœ¨ä¸­å¤®è˜‡å€ç«‹è¶³ï¼Œè¢«è¿«è½‰ç§»ã€‚" },
      { question: "é•·å¾åˆæœŸï¼Œç´…è»è¡Œè»é€Ÿåº¦ç·©æ…¢çš„ä¸»è¦åŸå› æ˜¯ï¼Ÿ", options: ["æ”œå¸¶å¤§é‡è¼œé‡", "é“è·¯è¢«ç ´å£", "ç­‰å¾…æ´è»", "å¤©æ°£æƒ¡åŠ£"], answer: 0, explanation: "ã€Œå¤§æ¬å®¶ã€å¼çš„è¡Œè»æ”œå¸¶äº†éå¤šç¬¨é‡ç‰©è³‡ï¼Œåš´é‡æ‹–ç´¯äº†éƒ¨éšŠé€Ÿåº¦ã€‚" }
    ],
    game: {
      scenario: "ã€æ­·å²æŠ‰æ“‡ã€‘å¤§æ’¤é€€é–‹å§‹ï¼Œå¾Œå‹¤éƒ¨å°‡é€ å¹£æ©Ÿã€Xå…‰æ©Ÿç”šè‡³ç¬¨é‡çš„æ¡Œæ¤…éƒ½æ‰“åŒ…å¸¶ä¸Šäº†ï¼ŒéšŠä¼è®Šæˆäº†ã€Œç”¬é“å¼ã€æ¬å®¶ï¼Œæ—¥è¡Œåƒ…å¹¾åé‡Œã€‚æ•µè»ç¢‰å ¡ç¾¤å°±åœ¨å‰æ–¹ï¼Œä½ ä½œç‚ºæŒ‡æ®å“¡å»ºè­°ï¼š",
      options: [
        { label: "å …æ±ºä¸Ÿæ£„é‡å‹è¼œé‡ï¼Œè¼•è£çªåœ", foodChange: -5, moraleChange: 10, result: "æ­·å²æ­£ç¢ºé¸æ“‡ï¼é›–ç„¶æå¤±äº†è¨­å‚™ï¼Œä½†éƒ¨éšŠæ©Ÿå‹•æ€§å¤§å¢ï¼Œæ¸›å°‘äº†çªç ´å°é–ç·šæ™‚çš„å‚·äº¡ã€‚" },
        { label: "å…¨æ•¸æ”œå¸¶ï¼Œé€™äº›æ˜¯é©å‘½çš„å®¶ç•¶", foodChange: -20, moraleChange: -15, result: "éŒ¯èª¤çš„ã€Œå¤§æ¬å®¶ã€ï¼éƒ¨éšŠè‡ƒè…«ä¸å ªï¼Œåœ¨æ¹˜æ±Ÿæˆ°å½¹ä¸­æˆç‚ºæ•µæ©Ÿè½Ÿç‚¸çš„æ´»é¶å­ï¼Œå‚·äº¡æ…˜é‡ã€‚" },
        { label: "å¾µç”¨æ°‘å¤«å”åŠ©æ¬é‹", foodChange: -15, moraleChange: -10, result: "å¢åŠ äº†ç³§é£Ÿæ¶ˆè€—ï¼Œä¸”æ°‘å¤«åœ¨æˆ°äº‚ä¸­å››æ•£é€ƒè·‘ï¼Œé€ æˆäº†æ›´å¤§çš„æ··äº‚ã€‚" },
        { label: "å°±åœ°æ©åŸ‹ï¼Œç•™ä¸‹æ¨™è¨˜å¾…æ—¥å¾Œå–å›", foodChange: -10, moraleChange: 0, result: "æŠ˜è¡·æ–¹æ¡ˆã€‚é›–ç„¶æ¸›è¼•äº†è² æ“”ï¼Œä½†æ©åŸ‹å·¥ä½œè€—è²»äº†å¯¶è²´çš„çªåœæ™‚é–“ã€‚" }
      ]
    }
  },
  {
    id: 1,
    title: "è¡€æˆ°æ¹˜æ±Ÿ",
    date: "1934å¹´11æœˆ",
    location: "å»£è¥¿å…¨å·",
    coords: [25.9286, 111.0720],
    description: "é•·å¾ä¸­æœ€æ…˜çƒˆçš„ä¸€æˆ°ã€‚ç´…è»çªç ´åœ‹æ°‘é»¨è»ç¬¬å››é“å°é–ç·šï¼Œä½†ç”±æ–¼éšŠä¼è‡ƒè…«å’ŒæŒ‡æ®å¤±èª¤ï¼Œä»˜å‡ºäº†æ¥µå…¶æ…˜é‡çš„ä»£åƒ¹ã€‚æ¹˜æ±Ÿæ°´è¢«ç´…è»æˆ°å£«çš„é®®è¡€æŸ“ç´…ã€‚",
    significance: "é›–ç„¶çªç ´äº†å°é–ï¼Œä½†æ…˜é‡çš„çŠ§ç‰²ï¼ˆæå…µæŠ˜å°‡éåŠï¼‰å¼•ç™¼äº†å»£å¤§æŒ‡æˆ°å“¡å°è»äº‹æŒ‡æ®éŒ¯èª¤çš„å¼·çƒˆä¸æ»¿ï¼Œç‚ºéµç¾©æœƒè­°çš„å¬é–‹åŸ‹ä¸‹ä¼ç­†ã€‚",
    figures: [
      { name: "é™³æ¨¹æ¹˜", role: "ç´…34å¸«å¸«é•·", desc: "ç‡é ˜å…¨å¸«æ“”ä»»å¾Œè¡›ï¼Œåœ¨æ¹˜æ±Ÿæ±å²¸é˜»æ“Šæ•µäººï¼Œå½ˆç›¡ç³§çµ•å¾Œè…¹éƒ¨ä¸­å½ˆï¼Œæ–·è…¸æ˜å¿—ï¼Œå£¯çƒˆçŠ§ç‰²ã€‚" },
      { name: "æ˜“ç›ªå¹³", role: "ç´…1åœ˜æ”¿å§”", desc: "åœ¨è…³å±±é‹ªæˆ°é¬¥ä¸­èº«è² é‡å‚·ï¼Œç‚ºä¸ç•¶ä¿˜è™œï¼Œå¥ªéè­¦è¡›å“¡çš„æ§è‡ªç›¡æ®‰åœ‹ã€‚" },
      { name: "æ—å½ª", role: "ç´…ä¸€è»åœ˜è»åœ˜é•·", desc: "æŒ‡æ®ç´…ä¸€è»åœ˜åœ¨æ¹˜æ±Ÿæ¸¡å£æ­»å®ˆï¼Œæ©è­·ä¸­å¤®ç¸±éšŠéæ±Ÿã€‚" }
    ],
    survival: {
      title: "ä¸‰å¹´ä¸é£²æ¹˜æ±Ÿæ°´",
      content: "æˆ°å½¹éå¾Œï¼Œç•¶åœ°ç™¾å§“æµå‚³è‘—ã€Œä¸‰å¹´ä¸é£²æ¹˜æ±Ÿæ°´ï¼Œåå¹´ä¸é£Ÿæ¹˜æ±Ÿé­šã€çš„èªªæ³•ï¼Œå¯è¦‹æˆ°æ³ä¹‹æ…˜çƒˆï¼Œå±æ©«éé‡ã€‚",
      poem: {
        text: "è‹±é›„è¡€æŸ“æ¹˜æ±Ÿæ¸¡ï¼Œæ±Ÿæ°´æ»”æ»”æ³£é¬¼ç¥ã€‚",
        source: "å¾Œäººè©©ä½œ",
        author: "ä½šå"
      }
    },
    stat: { label: "äººå“¡éŠ³æ¸›", value: "8.6è¬ â†’ 3è¬", icon: "users" },
    quizzes: [
      { question: "æ¹˜æ±Ÿæˆ°å½¹å¾Œï¼Œç´…è»äººæ•¸ç™¼ç”Ÿäº†ä»€éº¼è®ŠåŒ–ï¼Ÿ", options: ["å¢åŠ äº†ä¸€å€", "åŸºæœ¬æŒå¹³", "éŠ³æ¸›éåŠ", "å…¨éƒ¨çŠ§ç‰²"], answer: 2, explanation: "æ¹˜æ±Ÿæˆ°å½¹æ˜¯é•·å¾ä¸­æœ€æ…˜çƒˆçš„æˆ°å½¹ï¼Œç´…è»äººæ•¸ç”±8.6è¬éŠ³æ¸›è‡³3è¬é¤˜äººã€‚" },
      { question: "æ¹˜æ±Ÿæˆ°å½¹ä¸­ï¼Œè² è²¬å¾Œè¡›ä»»å‹™æœ€çµ‚å…¨è»è¦†æ²’çš„æ˜¯å“ªæ”¯éƒ¨éšŠï¼Ÿ", options: ["ç´…ä¸€è»åœ˜", "ç´…ä¸‰è»åœ˜", "ç´…34å¸«", "ç´…äº”è»åœ˜"], answer: 2, explanation: "ç´…34å¸«ä½œç‚ºã€Œçµ•å‘½å¾Œè¡›å¸«ã€ï¼Œç‚ºæ©è­·ä¸»åŠ›éæ±Ÿï¼Œæœ€çµ‚å…¨è»è¦†æ²’ã€‚" },
      { question: "æ¹˜æ±Ÿæˆ°å½¹çš„æ…˜æ•—ç›´æ¥å°è‡´äº†å¾Œä¾†å“ªæ¬¡æœƒè­°çš„å¬é–‹ï¼Ÿ", options: ["å¤ç”°æœƒè­°", "éµç¾©æœƒè­°", "ç“¦çª¯å ¡æœƒè­°", "æ´›å·æœƒè­°"], answer: 1, explanation: "æ…˜é‡çš„çŠ§ç‰²å¼•ç™¼äº†å°éŒ¯èª¤æŒ‡æ®çš„ä¸æ»¿ï¼Œç›´æ¥æ¨å‹•äº†éµç¾©æœƒè­°çš„å¬é–‹ã€‚" }
    ],
    game: {
      scenario: "ã€ç”Ÿæ­»é—œé ­ã€‘æ¶æ¸¡æ¹˜æ±Ÿï¼å…©å´æ•µè»å·²å½¢æˆå£è¢‹é™£ï¼Œå¾Œè¡›ç´…34å¸«è¢«æˆªæ–·åœ¨æ±Ÿæ±ã€‚æ±Ÿé¢æ•µæ©Ÿä¿¯è¡è½Ÿç‚¸ï¼Œæ±Ÿæ°´å·²æŸ“ç´…ã€‚ä¸»åŠ›éƒ¨éšŠé‚„æœ‰å¤§é‡äººå“¡æœªéæ±Ÿã€‚",
      options: [
        { label: "å‘½ä»¤ç´…34å¸«æ­»å®ˆé™£åœ°ï¼Œæ©è­·è»å§”éæ±Ÿ", foodChange: -5, moraleChange: -25, result: "å£¯çƒˆçš„çŠ§ç‰²ï¼ç´…34å¸«å…¨è»è¦†æ²’ï¼Œä¸»åŠ›å€–å­˜ä½†å£«æ°£è·Œè‡³è°·åº•ã€‚" },
        { label: "ä¸»åŠ›éƒ¨éšŠå›é ­æ¥æ‡‰å¾Œè¡›", foodChange: -30, moraleChange: 5, result: "è»äº‹è‡ªæ®ºï¼ä¸»åŠ›é‡å›åŒ…åœåœˆï¼Œå°è‡´ç´…è»é¢è‡¨å…¨è»è¦†æ²’çš„å±éšªã€‚" },
        { label: "åŒ–æ•´ç‚ºé›¶ï¼Œåˆ†æ•£çªåœ", foodChange: -15, moraleChange: -20, result: "éƒ¨éšŠå»ºåˆ¶è¢«æ‰“æ•£ï¼Œå¤§é‡éæˆ°é¬¥æ¸›å“¡ï¼Œç´…è»å¯èƒ½å°±æ­¤æ½°æ•£ã€‚" },
        { label: "æ‹‹æ£„æ‰€æœ‰æ–‡ä»¶èˆ‡æ©Ÿå™¨ï¼Œå¼·è¡Œæ¶‰æ°´", foodChange: -10, moraleChange: -5, result: "ä¸Ÿæ£„äº†æœ€å¾Œçš„åŒ…è¢±ï¼Œé›–ç„¶æå¤±ç‰©è³‡ï¼Œä½†ä¿ä½äº†å‰©é¤˜çš„æœ‰ç”ŸåŠ›é‡ã€‚" }
      ]
    }
  },
  {
    id: 2,
    title: "éµç¾©æœƒè­°",
    date: "1935å¹´1æœˆ",
    location: "è²´å·éµç¾©",
    coords: [27.7031, 106.9334],
    description: "ä¸­å…±ä¸­å¤®åœ¨éµç¾©å¬é–‹æ”¿æ²»å±€æ“´å¤§æœƒè­°ã€‚æœƒè­°é›†ä¸­å…¨åŠ›è§£æ±ºäº†ç•¶æ™‚å…·æœ‰æ±ºå®šæ„ç¾©çš„è»äº‹å’Œçµ„ç¹”å•é¡Œï¼Œç³¾æ­£äº†ã€Œå·¦ã€å‚¾æ•™æ¢ä¸»ç¾©éŒ¯èª¤ã€‚",
    significance: "ç¢ºç«‹äº†æ¯›æ¾¤æ±åœ¨é»¨å’Œç´…è»ä¸­çš„é ˜å°åœ°ä½ï¼Œåœ¨æ¥µå…¶å±æ€¥çš„é—œé ­æŒ½æ•‘äº†é»¨ï¼ŒæŒ½æ•‘äº†ç´…è»ï¼Œæ˜¯é»¨çš„æ­·å²ä¸Šä¸€å€‹ç”Ÿæ­»æ”¸é—œçš„è½‰æŠ˜é»ã€‚",
    figures: [
      { name: "æ¯›æ¾¤æ±", role: "æ”¿æ²»å±€å¸¸å§”", desc: "åœ¨æœƒè­°ä¸Šç²¾é—¢åˆ†æäº†ç¬¬äº”æ¬¡ååœå‰¿å¤±æ•—çš„åŸå› ï¼Œè¢«é¸ç‚ºæ”¿æ²»å±€å¸¸å§”ï¼Œé€²å…¥æ ¸å¿ƒæ±ºç­–å±¤ã€‚" },
      { name: "ç‹ç¨¼ç¥¥", role: "ç´…è»ç¸½æ”¿æ²»éƒ¨ä¸»ä»»", desc: "åœ¨æœƒè­°ä¸ŠæŠ•å‡ºäº†é—œéµä¸€ç¥¨ï¼Œæ——å¹Ÿé®®æ˜åœ°æ”¯æŒæ¯›æ¾¤æ±çš„ä¸»å¼µï¼Œæ‰¹è©•æå¾·çš„éŒ¯èª¤æŒ‡æ®ã€‚" },
      { name: "å¼µèå¤©", role: "æ”¿æ²»å±€å¸¸å§”", desc: "åœ¨æœƒè­°ä¸Šä½œäº†åå°ã€Œå·¦ã€å‚¾è»äº‹éŒ¯èª¤çš„å ±å‘Šï¼ˆåå ±å‘Šï¼‰ï¼Œæ¥æ›¿åšå¤è² ç¸½è²¬ã€‚" }
    ],
    survival: {
      title: "é›£å¾—çš„ä¼‘æ•´",
      content: "ä½”é ˜éµç¾©å¾Œï¼Œç´…è»ç²å¾—äº†é•·å¾ä»¥ä¾†é›£å¾—çš„12å¤©ä¼‘æ•´æ™‚é–“ã€‚æˆ°å£«å€‘è£œå……äº†çµ¦é¤Šï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œç²¾ç¥é¢è²Œç…¥ç„¶ä¸€æ–°ã€‚",
      poem: {
        text: "é›„é—œæ¼«é“çœŸå¦‚éµï¼Œè€Œä»Šé‚æ­¥å¾é ­è¶Šã€‚",
        source: "ã€Šæ†¶ç§¦å¨¥Â·å©å±±é—œã€‹",
        author: "æ¯›æ¾¤æ±"
      }
    },
    stat: { label: "æœƒè­°æ™‚é•·", value: "3å¤©", icon: "info" },
    quizzes: [
      { question: "éµç¾©æœƒè­°è¢«èªç‚ºæ˜¯ä¸­åœ‹å…±ç”¢é»¨æ­·å²ä¸Šçš„ä»€éº¼ï¼Ÿ", options: ["ç”Ÿæ­»æ”¸é—œçš„è½‰æŠ˜é»", "é•·å¾çš„çµæŸé»", "å»ºé»¨çš„é–‹å§‹", "åœ‹å…±åˆä½œçš„èµ·é»"], answer: 0, explanation: "éµç¾©æœƒè­°æŒ½æ•‘äº†é»¨å’Œç´…è»ï¼Œæ˜¯æ­·å²ä¸Šç”Ÿæ­»æ”¸é—œçš„è½‰æŠ˜é»ã€‚" },
      { question: "éµç¾©æœƒè­°ä¸»è¦è§£æ±ºäº†ä»€éº¼å•é¡Œï¼Ÿ", options: ["æ”¿æ²»å’Œæ€æƒ³å•é¡Œ", "è»äº‹å’Œçµ„ç¹”å•é¡Œ", "ç¶“æ¿Ÿå’Œæ–‡åŒ–å•é¡Œ", "å¤–äº¤å’Œçµ±ä¸€æˆ°ç·šå•é¡Œ"], answer: 1, explanation: "æœƒè­°é›†ä¸­å…¨åŠ›è§£æ±ºäº†ç•¶æ™‚æœ€ç·Šè¿«çš„è»äº‹å•é¡Œå’Œçµ„ç¹”å•é¡Œï¼ˆé ˜å°æ¬Šï¼‰ã€‚" },
      { question: "éµç¾©æœƒè­°äº‹å¯¦ä¸Šç¢ºç«‹äº†èª°åœ¨é»¨å’Œç´…è»ä¸­çš„é ˜å°åœ°ä½ï¼Ÿ", options: ["å‘¨æ©ä¾†", "æœ±å¾·", "æ¯›æ¾¤æ±", "ç‹ç¨¼ç¥¥"], answer: 2, explanation: "æœƒè­°å¢é¸æ¯›æ¾¤æ±ç‚ºæ”¿æ²»å±€å¸¸å§”ï¼Œäº‹å¯¦ä¸Šç¢ºç«‹äº†ä»–çš„é ˜å°åœ°ä½ã€‚" }
    ],
    game: {
      scenario: "ã€è·¯ç·šä¹‹çˆ­ã€‘æ”»å éµç¾©å¾Œï¼Œé»¨å…§å°ã€Œæå¾·å¼ã€çš„æ©Ÿæ¢°æŒ‡æ®æ€¨è²è¼‰é“ã€‚æ˜¯å¦å¬é–‹æ”¿æ²»å±€æ“´å¤§æœƒè­°é€²è¡Œå¾¹åº•æª¢è¨ï¼Ÿé‚„æ˜¯ç¹¼çºŒè½å¾å…±ç”¢åœ‹éš›é¡§å•çš„æŒ‡æ®ï¼Ÿ",
      options: [
        { label: "æ”¯æŒæ¯›æ¾¤æ±ï¼Œæ‰¹åˆ¤å–®ç´”é˜²ç¦¦è·¯ç·š", foodChange: 5, moraleChange: 40, result: "æ­·å²è½‰æŠ˜é»ï¼ç¢ºç«‹äº†æ­£ç¢ºçš„è»äº‹è·¯ç·šï¼Œç´…è»é‡ç²ç”Ÿæ©Ÿï¼Œå£«æ°£ç©ºå‰é«˜æ¼²ï¼" },
        { label: "ç¶­è­·æ¬Šå¨ï¼Œç¹¼çºŒè½å¾æå¾·æŒ‡æ®", foodChange: 0, moraleChange: -30, result: "éŒ¯èª¤è·¯ç·šç¹¼çºŒï¼éƒ¨éšŠå°‡ç¹¼çºŒåœ¨é‚£æ¢é€šå¾€å¤±æ•—çš„é“è·¯ä¸Šæ’å¾—é ­ç ´è¡€æµã€‚" },
        { label: "å°ˆæ³¨æ–¼è£œå……ç³§è‰ï¼Œä¸è«‡æ”¿æ²»", foodChange: 20, moraleChange: -10, result: "è‚šå­é£½äº†ï¼Œä½†è…¦è¢‹ä¾ç„¶ç³Šå¡—ã€‚ä¹‹å¾Œçš„æˆ°é¬¥ä¾ç„¶æœƒå› ç‚ºéŒ¯èª¤æŒ‡æ®è€Œå¤±æ•—ã€‚" },
        { label: "æå‡ºåˆ†å…µä½œæˆ°ä»¥åˆ†æ•£é¢¨éšª", foodChange: -10, moraleChange: -20, result: "å…µåŠ›åˆ†æ•£å°‡è¢«åœ‹æ°‘é»¨å„å€‹æ“Šç ´ï¼Œé€™æ˜¯åš´é‡çš„è»äº‹å†’éšªã€‚" }
      ]
    }
  },
  {
    id: 3,
    title: "å››æ¸¡èµ¤æ°´",
    date: "1935å¹´1æœˆ-3æœˆ",
    location: "å·é»”é‚Šç•Œ (èµ¤æ°´)",
    coords: [28.5900, 105.6972],
    description: "åœ¨æ¯›æ¾¤æ±æŒ‡æ®ä¸‹ï¼Œç´…è»åœ¨èµ¤æ°´æ²³å…©å²¸ç©¿æ’å¾€è¿”ï¼Œè²æ±æ“Šè¥¿ã€‚é€šéå››æ¬¡æ¸¡æ²³ï¼Œç´…è»å·§å¦™åœ°ç©¿æ’æ–¼åœ‹æ°‘é»¨è»é‡å…µé›†åœ˜ä¹‹é–“ï¼Œè¿·æƒ‘äº†æ•µäººã€‚",
    significance: "å¾¹åº•ç²‰ç¢äº†è”£ä»‹çŸ³ä¼åœ–åœæ®²ç´…è»æ–¼å·é»”æ»‡é‚Šå¢ƒçš„ç‹‚å¦„è¨ˆåŠƒï¼Œå–å¾—äº†æˆ°ç•¥è½‰ç§»ä¸­çš„ä¸»å‹•æ¬Šï¼Œè¢«æ¯›æ¾¤æ±è¦–ç‚ºå…¶ã€Œå¹³ç”Ÿå¾—æ„ä¹‹ç­†ã€ã€‚",
    figures: [
      { name: "æ¯›æ¾¤æ±", role: "æŒ‡æ®è€…", desc: "å±•ç¾äº†é«˜è¶…çš„è»äº‹æŒ‡æ®è—è¡“ï¼ŒæŒ‡æ®ç´…è»åœ¨å¹¾åè¬æ•µè»ä¸­ç©¿æ’è‡ªå¦‚ã€‚" },
      { name: "æœ±å¾·", role: "ç´…è»ç¸½å¸ä»¤", desc: "èˆ‡æ¯›æ¾¤æ±ç·Šå¯†é…åˆï¼Œç™¼å¸ƒä½œæˆ°å‘½ä»¤ï¼Œæ¿€å‹µå…¨è»å°‡å£«ã€‚" },
      { name: "åŠ‰ä¼¯æ‰¿", role: "ç¸½åƒè¬€é•·", desc: "å”åŠ©åˆ¶å®šä½œæˆ°è¨ˆåŠƒï¼Œè¦ªè‡¨å‰ç·šæŒ‡æ®éƒ¨åˆ†æˆ°é¬¥ã€‚" }
    ],
    survival: {
      title: "æ€¥è¡Œè»èˆ‡é‹å‹•æˆ°",
      content: "ç‚ºäº†èª¿å‹•æ•µäººï¼Œç´…è»å¿…é ˆåœ¨å±±è·¯ä¸­é »ç¹æ€¥è¡Œè»ã€‚ã€Œè‚¥çš„æ‹–ç˜¦ï¼Œç˜¦çš„æ‹–æ­»ã€ï¼Œé€™ç¨®é«˜å¼·åº¦çš„é‹å‹•æˆ°é›–ç„¶ç–²æ†Šï¼Œä½†å»æ˜¯ç”Ÿå­˜çš„å”¯ä¸€å¸Œæœ›ã€‚",
      poem: {
        text: "æˆ°å£«é›™è…³èµ°å¤©ä¸‹ï¼Œå››æ¸¡èµ¤æ°´å‡ºå¥‡å…µã€‚",
        source: "ã€Šé•·å¾çµ„æ­Œã€‹",
        author: "è‚–è¯"
      }
    },
    stat: { label: "æ­·æ™‚", value: "3å€‹å¤šæœˆ", icon: "info" },
    quizzes: [
      { question: "å››æ¸¡èµ¤æ°´çš„ä¸»è¦è»äº‹ç›®çš„æ˜¯ä»€éº¼ï¼Ÿ", options: ["æ¶ˆæ»…æ•µäººä¸»åŠ›", "å°‹æ‰¾ç³§é£Ÿ", "æ“ºè„«æ•µäººåœè¿½å µæˆª", "å»ºç«‹æ ¹æ“šåœ°"], answer: 2, explanation: "å››æ¸¡èµ¤æ°´é€šéé«˜åº¦æ©Ÿå‹•çš„é‹å‹•æˆ°ï¼ŒæˆåŠŸè·³å‡ºäº†æ•µäººçš„åŒ…åœåœˆã€‚" },
      { question: "æ¯›æ¾¤æ±å°‡å“ªå ´æˆ°å½¹ç¨±ç‚ºè‡ªå·±ã€Œå¹³ç”Ÿå¾—æ„ä¹‹ç­†ã€ï¼Ÿ", options: ["é¼ç€‹æˆ°å½¹", "å››æ¸¡èµ¤æ°´", "å¹³å‹é—œå¤§æ·", "ç™¾åœ˜å¤§æˆ°"], answer: 1, explanation: "å› ç‚ºåœ¨æ¥µåº¦åŠ£å‹¢ä¸‹ï¼Œé€šéæŒ‡æ®è—è¡“åŒ–éšªç‚ºå¤·ï¼Œæ•…è¢«ç¨±ç‚ºå¾—æ„ä¹‹ç­†ã€‚" },
      { question: "å››æ¸¡èµ¤æ°´ç™¼ç”Ÿåœ¨é•·å¾çš„å“ªå€‹éšæ®µï¼Ÿ", options: ["é•·å¾åˆæœŸ", "éµç¾©æœƒè­°ä¹‹å¾Œ", "éè‰åœ°ä¹‹å¾Œ", "æœƒå¸«ä¹‹å¾Œ"], answer: 1, explanation: "å››æ¸¡èµ¤æ°´ç™¼ç”Ÿåœ¨éµç¾©æœƒè­°ä¹‹å¾Œï¼Œæ˜¯æ¯›æ¾¤æ±é‡æ–°æŒ‡æ®å¾Œçš„ç¬¬ä¸€å ´å¤§ä»—ã€‚" }
    ],
    game: {
      scenario: "ã€é‹å‹•æˆ°ã€‘éƒ¨éšŠåœ¨èµ¤æ°´æ²³å…©å²¸ä¾†å›ç©¿æ’ï¼ˆå››æ¸¡ï¼‰ã€‚æˆ°å£«å€‘é›™è…³è·‘çˆ›ï¼Œé–‹å§‹æŠ±æ€¨ã€Œèµ°å¼“èƒŒä¸èµ°å¼“å¼¦ã€ã€ã€Œç›¡èµ°å†¤æ‰è·¯ã€ã€‚æ—å½ªä¹Ÿå¯«ä¿¡è¦æ±‚æ›æŒ‡æ®ã€‚",
      options: [
        { label: "å …æŒæ©Ÿå‹•ï¼Œå‘æˆ°å£«è§£é‡‹é€™æ˜¯ã€Œèª¿å‹•æ•µäººã€", foodChange: -15, moraleChange: 15, result: "æ­£ç¢ºçš„é‹å‹•æˆ°ï¼é›–ç„¶èº«é«”æ¥µåº¦ç–²å‹ï¼Œä½†æˆåŠŸè·³å‡ºäº†40è¬æ•µè»çš„é‡åœã€‚" },
        { label: "è½å¾æŠ±æ€¨ï¼Œé¸æ“‡èµ°ç›´ç·šå¿«è·¯", foodChange: 5, moraleChange: -40, result: "èµ°ç›´ç·šæ­£å¥½æ’é€²è”£ä»‹çŸ³ä½ˆç½®çš„ç¢‰å ¡ç·šï¼Œç´…è»é¢è‡¨æ»…é ‚ä¹‹ç½ã€‚" },
        { label: "åœä¸‹ä¼‘æ¯ç…®é£¯ï¼Œæ¢å¾©é«”åŠ›", foodChange: -10, moraleChange: -50, result: "ä»¥åµæ“ŠçŸ³ï¼ç´…è»æ­¤æ™‚æ¥µåº¦è™›å¼±ï¼Œé™£åœ°æˆ°å¿…æ•—ç„¡ç–‘ã€‚" },
        { label: "æ›´æ›æŒ‡æ®å“¡ï¼Œè®“æ—å½ªæŒ‡æ®", foodChange: 0, moraleChange: -20, result: "è»å¿ƒå‹•æ–ï¼ŒæŒ‡æ®æ··äº‚ï¼ŒéŒ¯å¤±äº†ç©¿æ’çš„æœ€ä½³æ™‚æ©Ÿã€‚" }
      ]
    }
  },
  {
    id: 4,
    title: "å·§æ¸¡é‡‘æ²™æ±Ÿ",
    date: "1935å¹´5æœˆ",
    location: "é›²å—ç¥¿å‹¸ (çšå¹³æ¸¡)",
    coords: [25.5511, 102.4667],
    description: "ç´…è»åˆ©ç”¨7éš»å°èˆ¹ï¼Œåœ¨ç•¶åœ°èˆ¹å·¥çš„å¹«åŠ©ä¸‹ï¼Œç¶“é9å¤©9å¤œï¼Œå°‡ä¸»åŠ›éƒ¨éšŠå…¨éƒ¨æ¸¡éé‡‘æ²™æ±Ÿã€‚ç•¶åœ‹æ°‘é»¨è»éšŠè¶•åˆ°æ™‚ï¼Œåªèƒ½æœ›æ±Ÿèˆˆå˜†ã€‚",
    significance: "ç´…è»å¾æ­¤è·³å‡ºäº†æ•¸åè¬æ•µè»çš„åŒ…åœåœˆï¼Œç²‰ç¢äº†æ•µäººåœè¿½å µæˆªçš„è¨ˆåŠƒï¼Œå–å¾—äº†æˆ°ç•¥è½‰ç§»çš„æ±ºå®šæ€§å‹åˆ©ã€‚",
    figures: [
      { name: "åŠ‰ä¼¯æ‰¿", role: "ç¸½åƒè¬€é•·", desc: "è¦ªè‡ªç‡é ˜å¹¹éƒ¨åœ˜ï¼ŒåŒ–è£æˆåœ‹æ°‘é»¨è»ï¼Œå¥‡è¥²å¥ªå–äº†çšå¹³æ¸¡å£ã€‚" },
      { name: "å¼µæ€å¾·", role: "ç´…è»æˆ°å£«", desc: "åœ¨é•·å¾ä¸­ç¸½æ˜¯æ‰¿æ“”æœ€ç¹é‡çš„ä»»å‹™ï¼Œå¾Œä¾†åœ¨é™åŒ—ç‡’ç‚­çŠ§ç‰²ï¼Œæ¯›æ¾¤æ±ç‚ºä»–å¯«ä¸‹ã€Šç‚ºäººæ°‘æœå‹™ã€‹ã€‚" },
      { name: "å¼µæœå£½", role: "ç•¶åœ°èˆ¹å·¥", desc: "ä»£è¡¨äº†37åç„¡åèˆ¹å·¥ï¼Œä»–å€‘ä¸é¡§ç–²å‹ï¼Œæ—¥å¤œæ“ºæ¸¡ï¼Œæ˜¯ç´…è»æ¸¡æ±Ÿçš„å¤§åŠŸè‡£ã€‚" }
    ],
    survival: {
      title: "èˆ‡æ™‚é–“è³½è·‘",
      content: "æ¸¡æ±Ÿå®Œå…¨ä¾è³´åƒ…æœ‰çš„å¹¾æ¢å°èˆ¹ã€‚ç‚ºäº†åŠ å¿«é€Ÿåº¦ï¼Œéƒ¨éšŠåš´æ ¼æ§åˆ¶ç§©åºï¼Œäººæ­‡èˆ¹ä¸æ­‡ã€‚èˆ¹å·¥å€‘å”±è‘—è™Ÿå­ï¼Œåœ¨æ¹æ€¥çš„æ±Ÿæµä¸­å¾€è¿”ã€‚",
      poem: {
        text: "é‡‘æ²™æ°´æ‹é›²å´–æš–ï¼Œå¤§æ¸¡æ©‹æ©«éµç´¢å¯’ã€‚",
        source: "ã€Šä¸ƒå¾‹Â·é•·å¾ã€‹",
        author: "æ¯›æ¾¤æ±"
      }
    },
    stat: { label: "æ¸¡èˆ¹æ•¸é‡", value: "åƒ…7éš»å°èˆ¹", icon: "info" },
    quizzes: [
      { question: "å·§æ¸¡é‡‘æ²™æ±Ÿæ¨™èªŒè‘—ç´…è»ï¼Ÿ", options: ["åˆ°é”äº†å»¶å®‰", "è·³å‡ºäº†æ•µäººçš„åŒ…åœåœˆ", "çµæŸäº†é•·å¾", "é–‹å§‹äº†æŠ—æ—¥æˆ°çˆ­"], answer: 1, explanation: "æ¸¡éé‡‘æ²™æ±Ÿå¾Œï¼Œç´…è»å°‡å¹¾åè¬è¿½å…µæ‹‹åœ¨èº«å¾Œï¼Œå–å¾—äº†æˆ°ç•¥è½‰ç§»çš„æ±ºå®šæ€§å‹åˆ©ã€‚" },
      { question: "ç´…è»æ¸¡éé‡‘æ²™æ±Ÿä¸»è¦ä¾é çš„æ˜¯ï¼Ÿ", options: ["æ¶è¨­æµ®æ©‹", "7éš»å°èˆ¹", "æ¸¸éå»", "æ•µäººçš„è»è‰¦"], answer: 1, explanation: "ç´…è»æ§åˆ¶äº†çšå¹³æ¸¡ï¼Œä¾é æ‰¾åˆ°çš„7éš»å°èˆ¹ï¼Œæ™å¤œä¸åœåœ°æ“ºæ¸¡äº†9å¤©9å¤œã€‚" },
      { question: "å·§æ¸¡é‡‘æ²™æ±Ÿæ™‚ï¼Œè² è²¬å¥ªå–æ¸¡å£çš„å…ˆé£éšŠæŒ‡æ®æ˜¯ï¼Ÿ", options: ["æ—å½ª", "å½­å¾·æ‡·", "åŠ‰ä¼¯æ‰¿", "è‘‰åŠè‹±"], answer: 2, explanation: "åŠ‰ä¼¯æ‰¿åŒ–è£å¥‡è¥²ï¼Œæ™ºå–äº†çšå¹³æ¸¡å£ã€‚" }
    ],
    game: {
      scenario: "ã€è»æ°‘é—œä¿‚ã€‘ä¾†åˆ°é‡‘æ²™æ±Ÿçšå¹³æ¸¡ï¼Œå…¨è»åªæœ‰7éš»å°èˆ¹ã€‚å¹¾è¬äººéæ±Ÿéœ€è¦9å¤©9å¤œï¼Œè¿½å…µå°‡è‡³ã€‚ç•¶åœ°èˆ¹å·¥ç–²æ†Šä¸å ªï¼Œäº¦æœ‰å‚³è¨€æ•µè»æœƒæ®ºèˆ¹å·¥å…¨å®¶ã€‚",
      options: [
        { label: "åš´æ ¼åŸ·è¡Œç´€å¾‹ï¼Œåšå¾…èˆ¹å·¥ï¼Œæ®ºè±¬æ¬¾å¾…", foodChange: -15, moraleChange: 25, result: "èˆ¹å·¥è¢«ç´…è»èª æ„æ„Ÿå‹•ï¼Œæ‹¼æ­»æ“ºæ¸¡ï¼Œå‰µé€ äº†å…¨è»ç„¡ä¸€æå¤±æ¸¡æ±Ÿçš„å¥‡è¹Ÿï¼" },
        { label: "å¼·è¡Œå¾µç”¨ï¼Œç”¨æ§é€¼è‘—èˆ¹å·¥åˆ’èˆ¹", foodChange: 0, moraleChange: -25, result: "èˆ¹å·¥æ¶ˆæ¥µæ€ å·¥ç”šè‡³é‘¿æ²‰èˆ¹éš»ï¼Œæ¸¡æ±Ÿå¤±æ•—ï¼Œéƒ¨éšŠèƒŒæ°´ä¸€æˆ°é¢è‡¨å…¨æ®²ã€‚" },
        { label: "ç ä¼æ¨¹æœ¨æ¶è¨­æµ®æ©‹", foodChange: -10, moraleChange: -10, result: "é‡‘æ²™æ±Ÿæ°´æµå¤ªæ€¥ï¼Œæµ®æ©‹æ ¹æœ¬æ¶ä¸èµ·ä¾†ï¼Œæµªè²»äº†å¯¶è²´çš„å…©å¤©æ™‚é–“ã€‚" },
        { label: "ä¸Ÿæ£„æ‰€æœ‰é¦¬åŒ¹ä»¥é¨°å‡ºèˆ¹ä½", foodChange: 15, moraleChange: -15, result: "é›–ç„¶åŠ å¿«äº†é€Ÿåº¦ï¼Œä½†å¤±å»æˆ°é¦¬å°å¾ŒçºŒéé›ªå±±è‰åœ°é€ æˆäº†å·¨å¤§å›°é›£ã€‚" }
      ]
    }
  },
  {
    id: 5,
    title: "é£›å¥ªç€˜å®šæ©‹",
    date: "1935å¹´5æœˆ",
    location: "å››å·ç€˜å®š",
    coords: [29.9147, 102.2317],
    description: "ç´…å››åœ˜æˆ°å£«åœ¨æ™å¤œå…¼ç¨‹240é‡Œå¾Œï¼Œ22åçªæ“ŠéšŠå“¡æ²¿è‘—åªå‰©ä¸‹éµéŠçš„æ©‹é¢ï¼Œå†’è‘—å°å²¸æ•µäººçš„æ©Ÿæ§æƒå°„ï¼Œå¼·è¡Œçªæ“Šï¼Œå¥ªå–äº†å¤§æ©‹ã€‚",
    significance: "ç²‰ç¢äº†è”£ä»‹çŸ³è—‰åŠ©å¤§æ¸¡æ²³å¤©éšªï¼Œè®“ç´…è»æˆç‚ºã€ŒçŸ³é”é–‹ç¬¬äºŒã€çš„ä¼åœ–ï¼Œæ‰“é–‹äº†åŒ—ä¸Šçš„é€šé“ã€‚",
    figures: [
      { name: "æ¥Šæˆæ­¦", role: "ç´…å››åœ˜æ”¿å§”", desc: "æŒ‡æ®ç´…å››åœ˜åœ¨24å°æ™‚å…§æ€¥è¡Œè»240é‡Œï¼Œå‰µé€ äº†é™¸è»è¡Œè»å²ä¸Šçš„å¥‡è¹Ÿï¼ŒæŒ‰æ™‚åˆ°é”ç€˜å®šæ©‹ã€‚" },
      { name: "ç‹é–‹æ¹˜", role: "ç´…å››åœ˜åœ˜é•·", desc: "èˆ‡æ¥Šæˆæ­¦å…±åŒæŒ‡æ®å¥ªæ©‹æˆ°é¬¥ï¼Œé¸æ‹”äº†22åå‹‡å£«çµ„æˆçªæ“ŠéšŠã€‚" },
      { name: "å»–å¤§ç ", role: "çªæ“ŠéšŠé•·", desc: "ç´…å››åœ˜äºŒé€£é€£é•·ï¼Œç‡é ˜22åå‹‡å£«æ”€è‘—éµç´¢ï¼Œå†’è‘—æ§æ—å½ˆé›¨è¡å‘å°å²¸ã€‚" }
    ],
    survival: {
      title: "æ¥µé™æ€¥è¡Œè»",
      content: "ç‚ºäº†æ¶åœ¨æ•µäººæ´å…µä¹‹å‰åˆ°é”ï¼Œç´…å››åœ˜å‰µé€ äº†å–®æ—¥è¡Œè»120å…¬é‡Œçš„å¥‡è¹Ÿã€‚æˆ°å£«å€‘é‚Šè·‘é‚Šåš¼ç”Ÿç±³ï¼Œç”šè‡³äº’ç›¸ç”¨ç¹©å­æ‹‰è‘—è·‘ï¼Œå…‹æœäº†èº«é«”çš„æ¥µé™ã€‚",
      poem: {
        text: "å¤§æ¸¡æ©‹æ©«éµç´¢å¯’ã€‚",
        source: "ã€Šä¸ƒå¾‹Â·é•·å¾ã€‹",
        author: "æ¯›æ¾¤æ±"
      }
    },
    stat: { label: "æ€¥è¡Œè»é€Ÿåº¦", value: "ä¸€æ™å¤œ240é‡Œ", icon: "info" },
    quizzes: [
      { question: "é£›å¥ªç€˜å®šæ©‹çš„çªæ“ŠéšŠå“¡æœ‰å¤šå°‘äººï¼Ÿ", options: ["100äºº", "50äºº", "22äºº", "18äºº"], answer: 2, explanation: "22åå‹‡å£«çµ„æˆäº†çªæ“ŠéšŠï¼Œæ”€è‘—éµç´¢å¥ªä¸‹äº†å¤§æ©‹ã€‚" },
      { question: "ç‚ºäº†å¥ªå–ç€˜å®šæ©‹ï¼Œç´…å››åœ˜å‰µé€ äº†æ€æ¨£çš„è¡Œè»ç´€éŒ„ï¼Ÿ", options: ["ä¸€æ™å¤œ120é‡Œ", "ä¸€æ™å¤œ240é‡Œ", "ä¸€æ™å¤œ80é‡Œ", "ä¸€æ™å¤œ300é‡Œ"], answer: 1, explanation: "ç´…å››åœ˜åœ¨æš´é›¨ä¸­ä¸€æ™å¤œå¥”è¥²240é‡Œï¼ˆç´„120å…¬é‡Œï¼‰ï¼ŒæŒ‰æ™‚è¶•åˆ°ç€˜å®šæ©‹ã€‚" },
      { question: "è”£ä»‹çŸ³æ›¾é è¨€ç´…è»æœƒåœ¨ç€˜å®šæ©‹é‡æ¼”å“ªä½æ­·å²äººç‰©çš„æ‚²åŠ‡ï¼Ÿ", options: ["é …ç¾½", "çŸ³é”é–‹", "æè‡ªæˆ", "æ´ªç§€å…¨"], answer: 1, explanation: "å¤ªå¹³å¤©åœ‹ç¿¼ç‹çŸ³é”é–‹æ›¾åœ¨å¤§æ¸¡æ²³ç•”å…¨è»è¦†æ²’ï¼Œè”£ä»‹çŸ³ä¼åœ–è®“ç´…è»æˆç‚ºã€ŒçŸ³é”é–‹ç¬¬äºŒã€ã€‚" }
    ],
    game: {
      scenario: "ã€æ¥µé™æŒ‘æˆ°ã€‘æ¥åˆ°æ­»å‘½ä»¤ï¼šä¸€æ™å¤œå¿…é ˆæ€¥è¡Œè»240é‡Œå¥ªä¸‹ç€˜å®šæ©‹ï¼å¤§é›¨å‚¾ç›†ï¼Œå±±è·¯æ¿•æ»‘ï¼Œå°å²¸æ•µè»ä¹Ÿåœ¨å¢æ´ã€‚å¤©é»‘äº†ï¼Œå°å²¸å‡ºç¾ç«å…‰ï¼ˆæ•µè»ï¼‰ã€‚",
      options: [
        { label: "é»èµ·ç«æŠŠï¼Œå‡å†’åœ‹æ°‘é»¨æ½°è»åŠ é€Ÿå‰é€²", foodChange: -10, moraleChange: 20, result: "å…µä¸å­è©ï¼é€™æ‹›æˆåŠŸè¿·æƒ‘äº†å°å²¸å·è»ï¼Œç´…å››åœ˜æŒ‰æ™‚åˆ°é”ä¸¦å¥ªä¸‹å¤§æ©‹ï¼" },
        { label: "æ‘¸é»‘å‰é€²ï¼Œé¿å…æš´éœ²", foodChange: -5, moraleChange: 5, result: "é€Ÿåº¦å¤ªæ…¢ï¼Œå¤©äº®æ™‚æ•µè»å¢æ´éƒ¨éšŠå·²ç‚¸æ¯€å¤§æ©‹ï¼Œç´…è»è¢«å›°åœ¨å¤§æ¸¡æ²³ç•”ã€‚" },
        { label: "åœä¸‹ä¼‘æ¯ç…®é£¯ï¼Œæ¢å¾©é«”åŠ›", foodChange: 5, moraleChange: -50, result: "å»¶èª¤æˆ°æ©Ÿï¼é€™æ˜¯è‡´å‘½çš„éŒ¯èª¤ï¼Œä»»å‹™å¤±æ•—æ„å‘³è‘—å…¨è»è¦†æ²’ã€‚" },
        { label: "æ‹‹æ£„æ­¦å™¨æ¸›é‡å¥”è¥²", foodChange: -5, moraleChange: -30, result: "é›–ç„¶è·‘åˆ°äº†ï¼Œä½†æ²’æœ‰é‡æ©Ÿæ§æ©è­·ï¼Œçªæ“ŠéšŠå“¡å…¨éƒ¨çŠ§ç‰²åœ¨éµç´¢æ©‹ä¸Šã€‚" }
      ]
    }
  },
  {
    id: 6,
    title: "çˆ¬é›ªå±±éè‰åœ°",
    date: "1935å¹´6æœˆ-8æœˆ",
    location: "å·è¥¿åŒ— (å¤¾é‡‘å±±/æ¾æ½˜)",
    coords: [31.9821, 103.5866],
    description: "ç´…è»ç¿»è¶Šäº†çµ‚å¹´ç©é›ªçš„å¤¾é‡‘å±±ï¼Œç©¿è¶Šäº†äººè·¡ç½•è‡³ã€æ°£å€™æƒ¡åŠ£ã€éå¸ƒæ²¼æ¾¤çš„æ¾æ½˜è‰åœ°ã€‚é€™æ˜¯é•·å¾ä¸­è‡ªç„¶ç’°å¢ƒæœ€æƒ¡åŠ£ã€éæˆ°é¬¥æ¸›å“¡æœ€åš´é‡çš„éšæ®µã€‚",
    significance: "é«”ç¾äº†ç´…è»æˆ°å£«æ¥µå¼·çš„æ„å¿—åŠ›å’Œé©å‘½æ¨‚è§€ä¸»ç¾©ç²¾ç¥ï¼Œæ˜¯é•·å¾ç²¾ç¥çš„é›†ä¸­é«”ç¾ã€‚",
    figures: [
      { name: "è€ç­é•·", role: "ç‚Šäº‹ç­é•·", desc: "èª²æ–‡ã€Šé‡‘è‰²çš„é­šé‰¤ã€‹åŸå‹ã€‚åœ¨è‰åœ°ä¸­ç…§é¡§ç—…è™Ÿï¼ŒæŠŠé£Ÿç‰©è®“çµ¦æˆ°å£«ï¼Œè‡ªå·±å› é£¢é¤“çŠ§ç‰²ã€‚" },
      { name: "è³€å­ç", role: "ç´…è»å¥³æˆ°å£«", desc: "åœ¨é•·å¾é€”ä¸­ç‚ºäº†æ©è­·å‚·å“¡ï¼Œèº«é«”å¤šè™•è¢«æ•µæ©Ÿå½ˆç‰‡æ“Šä¸­ï¼Œå¿ç—›èµ°å®Œé•·å¾ã€‚" },
      { name: "å¾ç‰¹ç«‹", role: "æ•™è‚²å®¶", desc: "å¹´è¿‘å…­æ—¬çš„è€æ•™è‚²å®¶ï¼Œé›–æœ‰é¦¬åŒ¹ä½†å¸¸è®“çµ¦å‚·ç—…å“¡é¨ï¼Œè‡ªå·±æ‹„è‘—æ£å­æ­¥è¡Œã€‚" }
    ],
    survival: {
      title: "åƒçš®å¸¶èˆ‡é‡èœ",
      content: "ç³§é£Ÿæ–·çµ•å¾Œï¼Œæˆ°å£«å€‘æŒ–é‡èœã€ç…®çš®å¸¶å……é£¢ã€‚è‰åœ°å¤©æ°£ç¬æ¯è¬è®Šï¼Œè¨±å¤šæˆ°å£«å› ç‚ºé™·å…¥æ³¥æ²¼æˆ–é«”æº«éä½è€Œåœ¨ç¡å¤¢ä¸­å†ä¹Ÿæ²’æœ‰é†’ä¾†ã€‚",
      poem: {
        text: "æ›´å–œå²·å±±åƒé‡Œé›ªï¼Œä¸‰è»éå¾Œç›¡é–‹é¡ã€‚",
        source: "ã€Šä¸ƒå¾‹Â·é•·å¾ã€‹",
        author: "æ¯›æ¾¤æ±"
      }
    },
    stat: { label: "ä¸»è¦å¨è„…", value: "é£¢é¤“ã€åš´å¯’ã€ç¼ºæ°§", icon: "info" },
    quizzes: [
      { question: "ç´…è»ç¿»è¶Šçš„ç¬¬ä¸€åº§å¤§é›ªå±±æ˜¯ï¼Ÿ", options: ["ç‰é¾é›ªå±±", "å¤¾é‡‘å±±", "é•·ç™½å±±", "å´‘å´™å±±"], answer: 1, explanation: "å¤¾é‡‘å±±æ˜¯ç´…è»é•·å¾ç¿»è¶Šçš„ç¬¬ä¸€åº§å¤§é›ªå±±ï¼Œæµ·æ‹”4000å¤šç±³ã€‚" },
      { question: "éè‰åœ°æ™‚ï¼Œç´…è»é¢è‡¨çš„æœ€å¤§å›°é›£ä¸åŒ…æ‹¬ï¼Ÿ", options: ["éå¸ƒæ²¼æ¾¤", "ç³§é£ŸçŸ­ç¼º", "æ°£å€™æƒ¡åŠ£", "æ•µè»å¤§è¦æ¨¡åœå‰¿"], answer: 3, explanation: "è‰åœ°äººè·¡ç½•è‡³ï¼Œåœ‹æ°‘é»¨è»éšŠä¹Ÿç„¡æ³•é€²å…¥ï¼Œå› æ­¤ä¸»è¦å›°é›£æ˜¯æƒ¡åŠ£çš„è‡ªç„¶ç’°å¢ƒå’Œé£¢é¤“ï¼Œè€Œéæ•µè»åœå‰¿ã€‚" },
      { question: "è‘—åçš„ã€Œé•·å¾ç²¾ç¥ã€åœ¨é€™ä¸€éšæ®µä¸»è¦é«”ç¾åœ¨ï¼Ÿ", options: ["éˆæ´»çš„æˆ°ç•¥æˆ°è¡“", "å¤§ç„¡ç•çš„é©å‘½æ¨‚è§€ä¸»ç¾©", "è»æ°‘é­šæ°´æƒ…", "åœ‹éš›ä¸»ç¾©ç²¾ç¥"], answer: 1, explanation: "é¢å°æ¥µç«¯çš„è‡ªç„¶ç’°å¢ƒï¼Œç´…è»å±•ç¾äº†æŒ‘æˆ°æ¥µé™ã€ä¸æ€•çŠ§ç‰²çš„é©å‘½æ¨‚è§€ä¸»ç¾©ç²¾ç¥ã€‚" }
    ],
    game: {
      scenario: "ã€çµ•å¢ƒæ±‚ç”Ÿã€‘é€²å…¥è‰åœ°ç¬¬ä¸ƒå¤©ï¼Œä¹¾ç³§è€—ç›¡ã€‚çœ¼å‰åªæœ‰ç„¡ç›¡çš„æ³¥æ²¼å’Œä¸çŸ¥åçš„é‡èœã€‚æˆ°å£«å€‘é–‹å§‹æµ®è…«ã€è…¹ç€‰ï¼Œç”šè‡³æœ‰äººæè­°å»æ¶åŠ«é™„è¿‘çš„å–‡å˜›å»Ÿã€‚",
      options: [
        { label: "åš´å®ˆç´€å¾‹ï¼Œç…®çš®å¸¶å’Œç‰›çš®é‹å……é£¢", foodChange: 5, moraleChange: 10, result: "é›–ç„¶é›£ä»¥ä¸‹åš¥ï¼Œä½†ç¶­è­·äº†ç´…è»ç´€å¾‹ï¼Œé è‘—å¾®è–„çš„ç†±é‡æ’éäº†æœ€å¾Œå¹¾å¤©ã€‚" },
        { label: "å˜—è©¦é¡è‰²é®®è±”çš„é‡è˜‘è‡", foodChange: 10, moraleChange: -30, result: "ä¸­æ¯’ï¼å¤§é‡æˆ°å£«å‡ºç¾å¹»è¦ºå’Œå˜”åï¼Œéƒ¨éšŠæˆ°é¬¥åŠ›æ­¸é›¶ã€‚" },
        { label: "æ®ºæ‰åƒ…å­˜çš„æˆ°é¦¬åˆ†é£Ÿ", foodChange: 25, moraleChange: -10, result: "å¿ç—›æ®ºé¦¬ã€‚é›–ç„¶å¤±å»äº†é‹è¼¸å·¥å…·ï¼Œä½†é€™é “è‚‰é£ŸæŒ½æ•‘äº†è¨±å¤šç€•æ­»æˆ°å£«çš„ç”Ÿå‘½ã€‚" },
        { label: "æ¶åŠ«å–‡å˜›å»Ÿçš„ç³§é£Ÿ", foodChange: 40, moraleChange: -50, result: "é•åæ°‘æ—æ”¿ç­–ï¼é›–ç„¶åƒé£½äº†ï¼Œä½†é­åˆ°è—æ—æ­¦è£çš„è¥²æ“Šï¼Œæå¤±æ¯”é£¢é¤“æ›´æ…˜é‡ã€‚" }
      ]
    }
  },
  {
    id: 7,
    title: "å³èµ·é®æœƒå¸«",
    date: "1935å¹´10æœˆ",
    location: "é™åŒ—å³èµ·é®",
    coords: [36.9274, 108.1762],
    description: "ä¸­å¤®ç´…è»åˆ°é”é™åŒ—å³èµ·é®ï¼Œèˆ‡é™åŒ—ç´…è»å‹åˆ©æœƒå¸«ã€‚é€™æ¨™èªŒè‘—ç´…ä¸€æ–¹é¢è»ä¸»åŠ›é•·å¾çš„å‹åˆ©çµæŸã€‚",
    significance: "å®£å‘Šäº†åœ‹æ°‘é»¨åœè¿½å µæˆªçš„å¤±æ•—ï¼Œç‚ºä¸­åœ‹é©å‘½å¤§æœ¬ç‡Ÿæ”¾åœ¨è¥¿åŒ—èˆ‰è¡Œäº†å¥ åŸºç¦®ï¼Œé–‹å•Ÿäº†ä¸­åœ‹é©å‘½çš„æ–°å±€é¢ã€‚",
    figures: [
      { name: "åŠ‰å¿—ä¸¹", role: "é™åŒ—ç´…è»é ˜å°äºº", desc: "å‰µå»ºäº†é™åŒ—é©å‘½æ ¹æ“šåœ°ï¼Œç‚ºä¸­å¤®ç´…è»æä¾›äº†è½è…³é»ï¼Œç†±æƒ…è¿æ¥ä¸­å¤®ç´…è»ã€‚" },
      { name: "ç¿’ä»²å‹³", role: "é™åŒ—ç´…è»é ˜å°äºº", desc: "æ™‚ä»»é™ç”˜é‚Šè˜‡ç¶­åŸƒæ”¿åºœä¸»å¸­ï¼Œç©æ¥µç±Œæªç‰©è³‡ï¼Œæ”¯æ´é•·å¾åˆ°é”çš„ä¸­å¤®ç´…è»ã€‚" },
      { name: "å½­å¾·æ‡·", role: "ç´…è»å‰æ•µç¸½æŒ‡æ®", desc: "æŒ‡æ®äº†è‘—åçš„ã€Œåˆ‡å°¾å·´ã€æˆ°é¬¥ï¼Œæ“Šæ½°äº†è¿½æ“Šçš„æ•µè»é¨å…µï¼Œä¿è­‰äº†æœƒå¸«çš„å®‰å…¨ã€‚" }
    ],
    survival: {
      title: "çª¯æ´èˆ‡å°ç±³",
      content: "åˆ°é”é™åŒ—å¾Œï¼Œæˆ°å£«å€‘ä½é€²äº†çª¯æ´ï¼Œåƒä¸Šäº†å°ç±³é£¯ã€‚é›–ç„¶æ¢ä»¶ä¾ç„¶è‰±è‹¦ï¼Œä½†ç›¸æ¯”è‰åœ°é›ªå±±ï¼Œé€™è£¡å·²ç¶“æ˜¯æº«æš–çš„å®¶ã€‚",
      poem: {
        text: "å±±é«˜è·¯é å‘æ·±ï¼Œå¤§è»ç¸±æ©«é¦³å¥”ã€‚èª°æ•¢æ©«åˆ€ç«‹é¦¬ï¼Ÿå”¯æˆ‘å½­å¤§å°‡è»ï¼",
        source: "ã€Šå…­è¨€è©©Â·çµ¦å½­å¾·æ‡·åŒå¿—ã€‹",
        author: "æ¯›æ¾¤æ±"
      }
    },
    stat: { label: "ç¸½é‡Œç¨‹", value: "äºŒè¬äº”åƒé‡Œ", icon: "info" },
    quizzes: [
      { question: "ä¸­å¤®ç´…è»é•·å¾çš„è½è…³é»æ˜¯å“ªè£¡ï¼Ÿ", options: ["é™åŒ—", "è¥¿è—", "æ–°ç–†", "åŒ—äº¬"], answer: 0, explanation: "ä¸­å¤®ç´…è»æœ€çµ‚åœ¨é™åŒ—å³èµ·é®èˆ‡ç•¶åœ°ç´…è»æœƒå¸«ï¼Œè½è…³é™åŒ—ã€‚" },
      { question: "èˆ‡ä¸­å¤®ç´…è»åœ¨å³èµ·é®æœƒå¸«çš„æ˜¯å“ªæ”¯éƒ¨éšŠï¼Ÿ", options: ["ç´…äºŒæ–¹é¢è»", "ç´…å››æ–¹é¢è»", "é™åŒ—ç´…è»ï¼ˆç´…åäº”è»åœ˜ï¼‰", "æ–°å››è»"], answer: 2, explanation: "å³èµ·é®æœƒå¸«ä¸»è¦æ˜¯ç´…ä¸€æ–¹é¢è»ï¼ˆä¸­å¤®ç´…è»ï¼‰èˆ‡é™åŒ—ç´…è»çš„æœƒå¸«ã€‚" },
      { question: "é•·å¾å‹åˆ©çµæŸæ¨™èªŒè‘—ä¸­åœ‹é©å‘½é‡å¿ƒè½‰ç§»åˆ°äº†ï¼Ÿ", options: ["æ±åŒ—", "è¥¿åŒ—", "è¥¿å—", "è¯å—"], answer: 1, explanation: "é•·å¾çš„å‹åˆ©ç‚ºä¸­åœ‹é©å‘½å¤§æœ¬ç‡Ÿæ”¾åœ¨è¥¿åŒ—èˆ‰è¡Œäº†å¥ åŸºç¦®ã€‚" }
    ],
    game: {
      scenario: "ã€æœ€å¾Œä¸€æˆ°ã€‘åˆ°é”å³èµ·é®ï¼Œæˆ°å£«å€‘çœ‹åˆ°äº†çª¯æ´ï¼ä½†å°¾éš¨çš„æ•µè»é¨å…µï¼ˆé¦¬å®¶è»ï¼‰ä¸ä¾ä¸é¥’ï¼Œä¼åœ–è¶ç´…è»ç«‹è¶³æœªç©©ç™¼å‹•æ”»æ“Šã€‚æ¯›æ¾¤æ±æè­°ã€Œåˆ‡æ‰é€™å€‹å°¾å·´ã€ã€‚",
      options: [
        { label: "åˆ©ç”¨åœ°å½¢è¨­ä¼ï¼Œæ‰“å€‹æ®²æ»…æˆ°", foodChange: -10, moraleChange: 50, result: "ã€Œåˆ‡å°¾å·´ã€æˆ°å½¹å¤§ç²å…¨å‹ï¼ç”¨ä¸€å ´æ¼‚äº®çš„å‹ä»—å®£å‘Šäº†é•·å¾çš„çµæŸï¼" },
        { label: "åŠ é€Ÿæ’¤å…¥æ ¹æ“šåœ°ï¼Œé¿æˆ°ä¿å…¨", foodChange: 5, moraleChange: 0, result: "é›–ç„¶å®‰å…¨äº†ï¼Œä½†å¸¶è‘—æ•µäººçš„è¿½æ“Šé€²å…¥æ ¹æ“šåœ°ï¼Œé¡¯å¾—ç‹¼ç‹½ï¼Œä¸”å¾Œæ‚£ç„¡çª®ã€‚" },
        { label: "å°±åœ°èˆ‰è¾¦è¯æ­¡æœƒæ…¶ç¥æœƒå¸«", foodChange: 10, moraleChange: -40, result: "å¤§æ„å¤±èŠå·ï¼æ…¶ç¥æ´»å‹•è¢«æ•µè»é¨å…µè¡æ•£ï¼Œæ¨‚æ¥µç”Ÿæ‚²ï¼Œæå¤±æ…˜é‡ã€‚" },
        { label: "è«‹æ±‚é™åŒ—ç´…è»ä»£ç‚ºé˜»æ“Š", foodChange: 0, moraleChange: -10, result: "é›–ç„¶åŠ‰å¿—ä¸¹é¡˜æ„å¹«å¿™ï¼Œä½†é¡¯ç¤ºäº†ä¸­å¤®ç´…è»çš„æ€¯æˆ°ï¼Œå½±éŸ¿äº†æœƒå¸«å¾Œçš„å¨ä¿¡ã€‚" }
      ]
    }
  }
];

// --- COMPONENTS ---

// EventSchematic.tsx
const EventSchematic = ({ id }) => {
  const RED = "#b71c1c";
  const BLUE = "#607d8b";
  const GREY = "#546e7a";

  const renderContent = () => {
    switch (id) {
      case 0: // ç‘é‡‘
        return (
          <React.Fragment>
            <text x="50" y="10" textAnchor="middle" fontSize="5" fill={GREY} fontWeight="bold" className="font-serif tracking-widest">æ•µè»åŒ…åœåœˆ</text>
            <circle cx="50" cy="50" r="35" fill="none" stroke={GREY} strokeWidth="1" strokeDasharray="4,2" />
            <path d="M 50 15 L 50 25 M 85 50 L 75 50 M 50 85 L 50 75 M 15 50 L 25 50" stroke={GREY} strokeWidth="2" markerEnd="url(#arrow-grey)" />
            <circle cx="50" cy="50" r="4" fill={RED} />
            <text x="50" y="58" textAnchor="middle" fontSize="5" fill={RED} fontWeight="bold" className="font-serif">ç‘é‡‘</text>
            <path d="M 45 50 L 15 50" stroke={RED} strokeWidth="3" markerEnd="url(#arrow)" />
            <text x="30" y="45" textAnchor="middle" fontSize="4" fill={RED} className="font-serif">çªåœè¥¿é€²</text>
          </React.Fragment>
        );
      case 1: // æ¹˜æ±Ÿ
        return (
          <React.Fragment>
             {/* River */}
             <path d="M 45 5 Q 55 50 45 95" stroke={BLUE} strokeWidth="12" fill="none" opacity="0.3" />
             <path d="M 45 5 Q 55 50 45 95" stroke="white" strokeWidth="1" fill="none" strokeDasharray="5,5" opacity="0.5" />
             <text x="40" y="20" fontSize="5" fill="#455a64" writingMode="tb" className="font-serif font-bold">æ¹˜æ±Ÿ</text>
             
             {/* Enemy Blocks */}
             <rect x="35" y="20" width="8" height="8" fill={GREY} opacity="0.8" />
             <rect x="35" y="70" width="8" height="8" fill={GREY} opacity="0.8" />
             <path d="M 39 28 L 39 40" stroke={GREY} strokeWidth="1" markerEnd="url(#arrow-grey)" />
             <path d="M 39 70 L 39 58" stroke={GREY} strokeWidth="1" markerEnd="url(#arrow-grey)" />

             {/* Red Army Crossing */}
             <path d="M 80 50 L 20 50" stroke={RED} strokeWidth="4" markerEnd="url(#arrow)" />
             <circle cx="50" cy="50" r="6" fill="#c62828" opacity="0.6">
                <animate attributeName="r" values="6;8;6" dur="2s" repeatCount="indefinite" />
             </circle>
             <text x="50" y="45" textAnchor="middle" fontSize="4" fill={RED} fontWeight="bold" className="font-serif">è¡€æˆ°çªç ´</text>
             <text x="80" y="55" textAnchor="end" fontSize="3" fill="#d32f2f">æŠ˜æéåŠ</text>
          </React.Fragment>
        );
      case 2: // éµç¾©
        return (
          <React.Fragment>
             {/* City Wall */}
             <rect x="25" y="30" width="50" height="35" rx="2" fill="#8d6e63" stroke="#5d4037" strokeWidth="2" />
             <rect x="45" y="25" width="10" height="8" fill="#5d4037" />
             <text x="50" y="50" textAnchor="middle" fontSize="6" fill="white" fontWeight="bold" className="font-serif">éµç¾©æœƒè­°</text>
             
             {/* Decision Paths */}
             <path d="M 20 85 L 40 65" stroke="#bdbdbd" strokeWidth="2" strokeDasharray="3,3" markerEnd="url(#arrow-grey)" />
             <text x="25" y="90" fontSize="3" fill="#757575">éŒ¯èª¤è·¯ç·š</text>
             
             <path d="M 50 30 L 50 10" stroke={RED} strokeWidth="4" markerEnd="url(#arrow)" />
             <text x="50" y="8" textAnchor="middle" fontSize="5" fill={RED} fontWeight="bold" className="font-serif">æ­£ç¢ºèˆªå‘</text>
             
             <circle cx="50" cy="50" r="20" fill="url(#shine)" opacity="0.2" />
          </React.Fragment>
        );
      case 3: // èµ¤æ°´
        return (
          <React.Fragment>
             {/* River bends */}
             <path d="M 15 10 C 90 20, 10 50, 85 60 C 10 70, 90 90, 15 95" stroke={BLUE} strokeWidth="8" fill="none" opacity="0.4" />
             <text x="80" y="15" textAnchor="middle" fontSize="4" fill={BLUE} className="font-serif font-bold">èµ¤æ°´æ²³</text>
             
             {/* Maneuver Lines */}
             <path d="M 60 20 Q 20 30 60 40" stroke={RED} strokeWidth="2" fill="none" markerEnd="url(#arrow)" />
             <path d="M 60 40 Q 90 50 40 60" stroke={RED} strokeWidth="2" fill="none" strokeDasharray="2,1" markerEnd="url(#arrow)" />
             <path d="M 40 60 Q 10 70 50 80" stroke={RED} strokeWidth="2" fill="none" markerEnd="url(#arrow)" />
             
             <text x="50" y="50" textAnchor="middle" fontSize="5" fill={RED} fontWeight="bold" className="font-serif bg-white">ç©¿æ’è¿‚è¿´</text>
          </React.Fragment>
        );
      case 4: // é‡‘æ²™æ±Ÿ
        return (
          <React.Fragment>
             <path d="M 5 30 C 40 90, 60 90, 95 30" stroke={BLUE} strokeWidth="10" fill="none" opacity="0.4" />
             <text x="50" y="85" textAnchor="middle" fontSize="5" fill="#455a64" className="font-serif font-bold">é‡‘æ²™æ±Ÿå¤©éšª</text>
             
             {/* Boat */}
             <path d="M 45 60 L 55 60 L 53 65 L 47 65 Z" fill="#3e2723" />
             <line x1="50" y1="60" x2="50" y2="55" stroke="#3e2723" />
             <rect x="48" y="55" width="4" height="3" fill="white" />
             
             {/* Route */}
             <path d="M 50 95 L 50 68" stroke={RED} strokeWidth="2" strokeDasharray="3,1" />
             <path d="M 50 55 L 50 10" stroke={RED} strokeWidth="3" markerEnd="url(#arrow)" />
             
             <text x="75" y="40" textAnchor="middle" fontSize="4" fill={RED} className="font-serif">ç”©æ‰è¿½å…µ</text>
          </React.Fragment>
        );
      case 5: // ç€˜å®šæ©‹
        return (
          <React.Fragment>
             {/* Cliffs */}
             <path d="M 0 0 L 25 0 L 25 100 L 0 100 Z" fill="#5d4037" />
             <path d="M 75 0 L 100 0 L 100 100 L 75 100 Z" fill="#5d4037" />
             
             {/* Raging River */}
             <rect x="25" y="0" width="50" height="100" fill={BLUE} opacity="0.6" />
             <path d="M 30 20 Q 50 30 70 20 M 30 50 Q 50 60 70 50 M 30 80 Q 50 90 70 80" stroke="white" strokeWidth="1" fill="none" opacity="0.5" />
             
             {/* Chains */}
             <line x1="25" y1="45" x2="75" y2="45" stroke="#212121" strokeWidth="1" />
             <line x1="25" y1="55" x2="75" y2="55" stroke="#212121" strokeWidth="1" />
             
             {/* Assault */}
             <path d="M 25 50 L 75 50" stroke={RED} strokeWidth="4" markerEnd="url(#arrow)" />
             <text x="50" y="35" textAnchor="middle" fontSize="5" fill="#ffd600" fontWeight="bold" className="font-serif drop-shadow-md">22å‹‡å£«</text>
             <circle cx="75" cy="50" r="3" fill="#ffd600" className="animate-ping" />
          </React.Fragment>
        );
      case 6: // é›ªå±±
        return (
          <React.Fragment>
             {/* Mountains */}
             <path d="M 10 90 L 30 50 L 50 90 L 70 40 L 90 90" fill="none" stroke="#78909c" strokeWidth="2" />
             {/* Snow Caps */}
             <path d="M 25 60 L 30 50 L 35 60 Z" fill="white" />
             <path d="M 65 50 L 70 40 L 75 50 Z" fill="white" />
             
             {/* Path */}
             <path d="M 10 95 Q 30 70 50 95 Q 70 60 90 30" stroke={RED} strokeWidth="2" fill="none" strokeDasharray="3,2" markerEnd="url(#arrow)" />
             <text x="70" y="30" textAnchor="middle" fontSize="4" fill={RED} fontWeight="bold" className="font-serif">è‰±é›£è·‹æ¶‰</text>
          </React.Fragment>
        );
      case 7: // å³èµ·é®
        return (
          <React.Fragment>
             {/* Base Area */}
             <path d="M 20 40 Q 50 20 80 40 Q 90 80 50 90 Q 10 80 20 40" fill="#fff9c4" stroke="#fbc02d" strokeWidth="2" strokeDasharray="4,2" />
             <text x="50" y="65" textAnchor="middle" fontSize="6" fill="#f57f17" className="font-serif font-bold">é™åŒ—æ ¹æ“šåœ°</text>
             
             {/* Arrival Arrows */}
             <path d="M 50 95 L 50 75" stroke={RED} strokeWidth="4" markerEnd="url(#arrow)" />
             <path d="M 85 60 L 70 50" stroke={RED} strokeWidth="3" markerEnd="url(#arrow)" />
             
             {/* Star */}
             <path d="M 50 35 L 53 45 L 63 45 L 55 52 L 58 62 L 50 55 L 42 62 L 45 52 L 37 45 L 47 45 Z" fill="#d32f2f" />
             <text x="50" y="25" textAnchor="middle" fontSize="5" fill={RED} fontWeight="bold" className="font-serif">å‹åˆ©æœƒå¸«</text>
          </React.Fragment>
        );
      default: return null;
    }
  };

  return (
    <div className="w-full h-40 bg-[#f5f5f5] rounded-lg border border-[#d7ccc8] mb-4 overflow-hidden relative shadow-inner">
      <div className="absolute top-1 left-2 text-[10px] text-[#a1887f] font-bold uppercase tracking-widest font-serif border-b border-[#d7ccc8] pb-0.5">æˆ°è¡“ç¤ºæ„åœ–</div>
      <svg viewBox="0 0 100 100" className="w-full h-full" preserveAspectRatio="xMidYMid meet">
        <defs>
          <marker id="arrow" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
            <path d="M0,0 L0,6 L6,3 z" fill="#d32f2f" />
          </marker>
          <marker id="arrow-grey" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
            <path d="M0,0 L0,6 L6,3 z" fill="#546e7a" />
          </marker>
          <radialGradient id="shine">
            <stop offset="0%" stopColor="#ffd600" stopOpacity="0.8" />
            <stop offset="100%" stopColor="#ffd600" stopOpacity="0" />
          </radialGradient>
        </defs>
        {renderContent()}
      </svg>
    </div>
  );
};

// QuizModal.tsx
const QuizModal = ({ quizzes, isOpen, onClose }) => {
  const [currentQIndex, setCurrentQIndex] = useState(0);
  const [selected, setSelected] = useState(null);
  const [showResult, setShowResult] = useState(false);
  const [score, setScore] = useState(0);
  const [isFinished, setIsFinished] = useState(false);

  useEffect(() => {
    if (isOpen) resetQuiz();
  }, [isOpen]);

  const resetQuiz = () => {
    setCurrentQIndex(0);
    setSelected(null);
    setShowResult(false);
    setScore(0);
    setIsFinished(false);
  };

  if (!isOpen || !quizzes || quizzes.length === 0) return null;
  const currentQuiz = quizzes[currentQIndex];

  const handleCheck = () => {
    if (selected !== null) {
      setShowResult(true);
      if (selected === currentQuiz.answer) setScore(prev => prev + 1);
    }
  };

  const handleNext = () => {
    if (currentQIndex < quizzes.length - 1) {
      setCurrentQIndex(prev => prev + 1);
      setSelected(null);
      setShowResult(false);
    } else {
      setIsFinished(true);
    }
  };

  return (
    <div className="fixed inset-0 bg-slate-900/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fade-in-zoom">
      <div className="bg-[#fff8e1] rounded-xl shadow-2xl max-w-lg w-full p-6 border-4 border-amber-600 relative overflow-hidden">
        <div className="flex justify-between items-center mb-6 border-b border-amber-200 pb-4">
          <h3 className="text-xl font-bold text-amber-800 flex items-center gap-2 font-serif">
            <HelpCircle size={24} /> éš¨å ‚çŸ¥è­˜å•ç­”
          </h3>
          <button onClick={onClose} className="text-stone-500 hover:text-stone-800 transition-colors">
            <X size={24} />
          </button>
        </div>

        {!isFinished ? (
          <>
            <div className="mb-6">
              <div className="flex justify-between text-xs font-bold text-stone-500 uppercase mb-1">
                <span>å•é¡Œ {currentQIndex + 1} / {quizzes.length}</span>
                <span>å¾—åˆ†: {score}</span>
              </div>
              <div className="w-full bg-amber-100 h-2.5 rounded-full overflow-hidden border border-amber-200">
                <div 
                  className="bg-amber-600 h-full transition-all duration-300" 
                  style={{ width: `${((currentQIndex + 1) / quizzes.length) * 100}%` }}
                ></div>
              </div>
            </div>

            <h4 className="text-lg font-bold text-stone-800 mb-6 min-h-[3.5rem] leading-snug">
              {currentQuiz.question}
            </h4>

            <div className="space-y-3 mb-6">
              {currentQuiz.options.map((option, idx) => {
                let btnClass = "w-full text-left p-4 rounded-xl border-2 transition-all duration-200 outline-none relative ";
                if (showResult) {
                  if (idx === currentQuiz.answer) btnClass += "bg-green-50 border-green-600 text-green-900 font-bold shadow-sm";
                  else if (idx === selected && idx !== currentQuiz.answer) btnClass += "bg-red-50 border-red-500 text-red-900 opacity-80";
                  else btnClass += "border-stone-200 opacity-40";
                } else {
                  btnClass += selected === idx 
                    ? "border-amber-500 bg-amber-50 text-amber-900 shadow-md transform scale-[1.01]" 
                    : "border-stone-300 hover:border-amber-300 hover:bg-amber-50/50 text-stone-700 bg-white";
                }
                return (
                  <button key={idx} onClick={() => !showResult && setSelected(idx)} className={btnClass} disabled={showResult}>
                    <div className="flex justify-between items-center">
                      <span className="flex gap-3">
                        <span className={`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border shrink-0 ${
                          showResult && idx === currentQuiz.answer ? 'bg-green-600 text-white border-green-600' : 
                          (selected === idx ? 'bg-amber-500 text-white border-amber-500' : 'bg-stone-100 text-stone-500 border-stone-300')
                        }`}>
                          {String.fromCharCode(65 + idx)}
                        </span>
                        {option}
                      </span>
                      {showResult && idx === currentQuiz.answer && <CheckCircle size={20} className="text-green-600" />}
                      {showResult && idx === selected && idx !== currentQuiz.answer && <XCircle size={20} className="text-red-600" />}
                    </div>
                  </button>
                );
              })}
            </div>

            <div className="mt-4">
              {showResult && currentQuiz.explanation && (
                <div className="mb-4 bg-white p-4 rounded-lg text-sm text-stone-700 border border-amber-200 shadow-sm">
                  <span className="font-bold text-amber-700 mr-2 block mb-1">ğŸ’¡ çŸ¥è­˜é»è§£æ:</span>
                  {currentQuiz.explanation}
                </div>
              )}
              <div className="flex justify-end">
                {!showResult ? (
                  <button 
                    onClick={handleCheck} 
                    disabled={selected === null} 
                    className="px-6 py-2 bg-amber-700 text-white rounded-lg font-bold hover:bg-amber-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md"
                  >
                    æäº¤ç­”æ¡ˆ
                  </button>
                ) : (
                  <button 
                    onClick={handleNext} 
                    className="flex items-center gap-2 px-6 py-2 bg-stone-800 text-white rounded-lg font-bold hover:bg-stone-900 transition-all shadow-md"
                  >
                    {currentQIndex < quizzes.length - 1 ? "ä¸‹ä¸€é¡Œ" : "æŸ¥çœ‹æˆç¸¾"} <ChevronRight size={18} />
                  </button>
                )}
              </div>
            </div>
          </>
        ) : (
          <div className="text-center py-6">
            <div className="relative inline-block mb-4">
              <div className={`p-4 rounded-full ${score === quizzes.length ? 'bg-amber-50 border-4 border-amber-400' : 'bg-stone-100'}`}>
                <Trophy size={64} className={`${score === quizzes.length ? 'text-amber-400' : 'text-stone-300'}`} />
              </div>
            </div>
            <h2 className="text-3xl font-black text-stone-800 mb-2 font-serif">æ¸¬é©—çµæŸ</h2>
            <p className="text-stone-500 mb-6">æ‚¨çš„æ­·å²çŸ¥è­˜æ°´å¹³</p>
            <div className="text-6xl font-black text-amber-700 mb-2 tracking-tight">
              {score} <span className="text-2xl text-stone-400 font-medium">/ {quizzes.length}</span>
            </div>
            <p className="font-bold text-lg mb-8 text-stone-700">
              {score === quizzes.length ? "å¤ªæ£’äº†ï¼æ‚¨æ˜¯é•·å¾çŸ¥è­˜é€šï¼" : (score >= quizzes.length / 2 ? "æˆç¸¾ä¸éŒ¯ï¼Œç¹¼çºŒä¿æŒï¼" : "å»ºè­°å†ä»”ç´°é–±è®€æ­·å²è³‡æ–™å–”ã€‚")}
            </p>
            <div className="flex justify-center gap-4">
              <button onClick={resetQuiz} className="flex items-center gap-2 px-6 py-2 border-2 border-stone-300 text-stone-600 rounded-lg hover:bg-stone-100 font-bold transition-colors">
                <RefreshCw size={18} /> é‡æ¸¬
              </button>
              <button onClick={onClose} className="px-8 py-2 bg-red-800 text-white rounded-lg font-bold hover:bg-red-900 shadow-lg transition-all">
                å®Œæˆ
              </button>
            </div>
          </div>
        )}
      </div>
    </div>
  );
};

// SurvivalGameModal.tsx
const SurvivalGameModal = ({ milestones, isOpen, onClose }) => {
  const [gameState, setGameState] = useState('intro');
  const [currentStage, setCurrentStage] = useState(0);
  const [food, setFood] = useState(60); 
  const [morale, setMorale] = useState(60); 
  const [feedback, setFeedback] = useState(null);
  const [lastChanges, setLastChanges] = useState(null);
  const [randomEvent, setRandomEvent] = useState(null);
  
  const [foodShaking, setFoodShaking] = useState(false);
  const [moraleShaking, setMoraleShaking] = useState(false);

  useEffect(() => { if (isOpen) resetGame(); }, [isOpen]);

  const resetGame = () => {
    setGameState('intro');
    setCurrentStage(0);
    setFood(60);
    setMorale(60);
    setFeedback(null);
    setLastChanges(null);
    setRandomEvent(null);
  };

  const handleOptionSelect = (option) => {
    const newFood = Math.min(100, Math.max(0, food + option.foodChange));
    const newMorale = Math.min(100, Math.max(0, morale + option.moraleChange));
    
    if (option.foodChange < 0) { setFoodShaking(true); setTimeout(() => setFoodShaking(false), 500); }
    if (option.moraleChange < 0) { setMoraleShaking(true); setTimeout(() => setMoraleShaking(false), 500); }

    setFood(newFood);
    setMorale(newMorale);
    setFeedback(option.result);
    setLastChanges({ food: option.foodChange, morale: option.moraleChange });

    if (newFood <= 0 || newMorale <= 0) { setTimeout(() => setGameState('gameover'), 2000); }
  };

  const nextStage = () => {
    setFeedback(null);
    setLastChanges(null);
    setRandomEvent(null);

    const eventChance = Math.random();
    let currentFood = food;
    let currentMorale = morale;

    if (eventChance < 0.3 && currentStage < milestones.length - 1 && currentFood > 10 && currentMorale > 10) {
        const events = [
            { text: "é­é‡æ•µæ©Ÿè½Ÿç‚¸ï¼ç³§é£Ÿè¢«ç‡’æ¯€ï¼", f: -10, m: 0 },
            { text: "æš´é›¨å°è‡´å‚·å¯’æµè¡Œï¼Œå£«æ°£ä½è½ã€‚", f: 0, m: -10 },
            { text: "è¿·è·¯å¤šèµ°äº†å†¤æ‰è·¯ï¼Œæ¶ˆè€—é«”åŠ›ã€‚", f: -5, m: -5 }
        ];
        const evt = events[Math.floor(Math.random() * events.length)];
        currentFood = Math.max(0, currentFood + evt.f);
        currentMorale = Math.max(0, currentMorale + evt.m);
        setFood(currentFood);
        setMorale(currentMorale);
        setRandomEvent(evt.text);
        setFoodShaking(true);
        setMoraleShaking(true);
        setTimeout(() => {setFoodShaking(false); setMoraleShaking(false);}, 500);
    }

    if (currentFood <= 0 || currentMorale <= 0) { setGameState('gameover'); return; }
    if (currentStage < milestones.length - 1) { setCurrentStage(prev => prev + 1); } else { setGameState('result'); }
  };

  const getRank = (score) => {
    if (score >= 160) return { title: "é•·å¾è»ç¥", color: "text-amber-600", desc: "ä½ çš„æŒ‡æ®è—è¡“å‡ºç¥å…¥åŒ–ï¼Œå ªæ¯”æ¯›æ¾¤æ±ï¼" };
    if (score >= 120) return { title: "å„ªç§€æŒ‡æ®å“¡", color: "text-red-700", desc: "ä½ å¸¶é ˜éƒ¨éšŠå®Œå¥½ç„¡æåœ°åˆ°é”äº†é™åŒ—ã€‚" };
    if (score >= 80) return { title: "åˆæ ¼æˆ°å£«", color: "text-blue-700", desc: "é›–ç„¶æ­·ç¶“ç£¨é›£ï¼Œä½†ä½ å …æŒåˆ°äº†æœ€å¾Œã€‚" };
    return { title: "å€–å­˜è€…", color: "text-stone-700", desc: "ä½ å‹‰å¼·æ´»äº†ä¸‹ä¾†ï¼Œé€™æœ¬èº«å°±æ˜¯å¥‡è¹Ÿã€‚" };
  };

  if (!isOpen) return null;
  const currentMilestone = milestones[currentStage];
  const challenge = currentMilestone.game;
  const totalScore = food + morale;
  const rank = getRank(totalScore);

  return (
    <div className="fixed inset-0 bg-slate-900/90 backdrop-blur-md flex items-center justify-center z-50 p-4 animate-fade-in-zoom">
      <div className="bg-[#fdfbf7] rounded-xl max-w-4xl w-full shadow-2xl overflow-hidden border-4 border-stone-700 flex flex-col max-h-[95vh] relative">
        <div className="bg-[#3e2723] p-4 text-[#fff8e1] flex justify-between items-center shrink-0 shadow-lg z-10 border-b border-stone-700">
          <div className="flex items-center gap-2">
            <Trophy size={20} className="text-amber-400" />
            <h2 className="text-lg font-bold tracking-widest uppercase font-serif">ç”Ÿå­˜æŒ‘æˆ°æ¨¡å¼</h2>
          </div>
          <button onClick={onClose} className="hover:text-white transition-colors bg-white/10 p-1.5 rounded-full hover:bg-white/20">
            <X size={20} />
          </button>
        </div>
        
        {gameState === 'intro' && (
          <div className="p-8 flex flex-col items-center text-center space-y-6 bg-[url('https://www.transparenttextures.com/patterns/cream-dust.png')] overflow-y-auto h-full justify-center">
            <div className="w-24 h-24 bg-[#8b1c1c] rounded-full flex items-center justify-center mb-2 shadow-xl border-4 border-stone-200">
              <Wheat size={48} className="text-amber-300" />
            </div>
            <h1 className="text-4xl font-black text-stone-800 font-serif">é‡èµ°é•·å¾è·¯</h1>
            <div className="bg-orange-50 p-6 rounded-lg border border-orange-200 max-w-lg mx-auto shadow-sm relative">
              <div className="absolute top-2 left-2 text-orange-300"><Scroll size={20} /></div>
              <p className="text-stone-700 text-base md:text-lg leading-relaxed font-serif text-justify font-medium pt-2">
                1934å¹´ï¼Œç”±æ–¼ç¬¬äº”æ¬¡åã€Œåœå‰¿ã€å¤±æ•—ï¼Œåœ‹æ°‘é»¨è»éšŠæ­¥æ­¥é€²é€¼ã€‚ä¸­å¤®ç´…è»è¢«è¿«æ’¤é›¢æ ¹æ“šåœ°ï¼Œé–‹å§‹æˆ°ç•¥è½‰ç§»ã€‚å‰æœ‰å µæˆªï¼Œå¾Œæœ‰è¿½å…µã€‚ä½ è‡¨å±å—å‘½ï¼Œå¿…é ˆå¸¶é ˜éƒ¨éšŠåœ¨çµ•å¢ƒä¸­æ±‚ç”Ÿã€‚
              </p>
            </div>
            <div className="grid grid-cols-2 gap-8 w-full max-w-sm mt-4">
              <div className="flex flex-col items-center gap-2 p-4 bg-white rounded-xl border border-stone-200 shadow-sm">
                <span className="font-bold text-orange-500 text-3xl">60</span>
                <div className="flex items-center gap-1 text-xs text-stone-500 uppercase font-bold"><Wheat size={14}/> åˆå§‹ç³§é£Ÿ</div>
              </div>
              <div className="flex flex-col items-center gap-2 p-4 bg-white rounded-xl border border-stone-200 shadow-sm">
                <span className="font-bold text-red-700 text-3xl">60</span>
                <div className="flex items-center gap-1 text-xs text-stone-500 uppercase font-bold"><Heart size={14}/> åˆå§‹å£«æ°£</div>
              </div>
            </div>
            <button onClick={() => setGameState('playing')} className="px-10 py-3 bg-[#b71c1c] text-[#fff8e1] text-xl font-bold rounded-xl shadow-lg hover:shadow-xl hover:bg-[#c62828] transform hover:-translate-y-0.5 active:translate-y-0 transition-all w-full md:w-auto mt-6 border border-red-400">
              æ¥å—å‘½ä»¤
            </button>
          </div>
        )}

        {gameState === 'playing' && challenge && (
          <div className="flex flex-col h-full bg-[url('https://www.transparenttextures.com/patterns/cream-dust.png')]">
            <div className="bg-[#efebe9] p-4 flex justify-around items-center border-b border-stone-300 shadow-inner shrink-0 z-10">
                <div className={`flex flex-col md:flex-row items-center gap-2 md:gap-4 w-1/2 justify-center transition-transform ${foodShaking ? 'translate-x-[-2px]' : ''}`}>
                  <div className="flex items-center gap-2 text-orange-600 font-bold text-sm uppercase"><Wheat size={18} /> ç³§é£Ÿ</div>
                  <div className="w-full max-w-[140px] h-4 bg-stone-300 rounded-full overflow-hidden border border-stone-400 relative shadow-inner">
                    <div className={`h-full transition-all duration-700 ${food <= 30 ? 'bg-red-700' : 'bg-orange-500'}`} style={{ width: `${food}%` }}></div>
                  </div>
                  <span className={`font-mono font-bold w-8 text-right text-lg ${food <= 30 ? 'text-red-700' : 'text-stone-700'}`}>{food}</span>
                </div>
                <div className="h-8 w-px bg-stone-300"></div>
                <div className={`flex flex-col md:flex-row items-center gap-2 md:gap-4 w-1/2 justify-center transition-transform ${moraleShaking ? 'translate-x-[-2px]' : ''}`}>
                  <div className="flex items-center gap-2 text-red-700 font-bold text-sm uppercase"><Heart size={18} /> å£«æ°£</div>
                  <div className="w-full max-w-[140px] h-4 bg-stone-300 rounded-full overflow-hidden border border-stone-400 relative shadow-inner">
                    <div className={`h-full transition-all duration-700 ${morale <= 30 ? 'bg-red-800' : 'bg-red-600'}`} style={{ width: `${morale}%` }}></div>
                  </div>
                  <span className={`font-mono font-bold w-8 text-right text-lg ${morale <= 30 ? 'text-red-700' : 'text-stone-700'}`}>{morale}</span>
                </div>
            </div>
            {randomEvent && (
              <div className="bg-red-100 border-b border-red-200 p-2 text-center text-red-800 font-bold flex items-center justify-center gap-2 shadow-sm">
                <AlertTriangle size={18} />çªç™¼ï¼š{randomEvent}
              </div>
            )}
            <div className="flex-1 overflow-y-auto p-6 md:p-8">
                <div className="flex justify-between items-center mb-4 pb-2 border-b border-stone-200">
                  <span className="text-xs font-bold text-stone-500 border border-stone-300 px-2 py-1 rounded bg-white">ç¬¬ {currentStage + 1} é—œ</span>
                  <span className="text-sm font-bold text-stone-700 font-serif tracking-wide">{currentMilestone.date}</span>
                </div>
                <h2 className="text-2xl md:text-3xl font-black text-stone-800 mb-4 font-serif">{currentMilestone.title}</h2>
                <div className="bg-white p-6 rounded-xl border border-stone-300 mb-8 shadow-sm flex gap-4">
                  <p className="text-base md:text-lg text-stone-700 font-medium leading-relaxed font-serif">{challenge.scenario}</p>
                </div>
                {feedback ? (
                  <div className="animate-fade-in-zoom bg-orange-50 border-2 border-orange-100 rounded-xl p-8 shadow-lg text-center max-w-2xl mx-auto">
                    <h3 className="text-xl font-bold text-stone-800 mb-2 font-serif">å¾Œæœ</h3>
                    <p className="text-stone-600 mb-8 text-lg">{feedback}</p>
                    <div className="flex justify-center gap-12 mb-8 border-t border-b border-orange-200 py-4">
                      {lastChanges && (
                        <>
                          <div className={`flex flex-col items-center ${lastChanges.food === 0 ? 'opacity-50' : ''}`}>
                            <span className="text-xs text-stone-500 font-bold uppercase mb-1">ç³§é£Ÿè®Šå‹•</span>
                            <span className={`text-2xl font-black ${lastChanges.food >= 0 ? 'text-green-600' : 'text-red-700'}`}>{lastChanges.food > 0 ? '+' : ''}{lastChanges.food}</span>
                          </div>
                          <div className={`flex flex-col items-center ${lastChanges.morale === 0 ? 'opacity-50' : ''}`}>
                            <span className="text-xs text-stone-500 font-bold uppercase mb-1">å£«æ°£è®Šå‹•</span>
                            <span className={`text-2xl font-black ${lastChanges.morale >= 0 ? 'text-green-600' : 'text-red-700'}`}>{lastChanges.morale > 0 ? '+' : ''}{lastChanges.morale}</span>
                          </div>
                        </>
                      )}
                    </div>
                    <button onClick={nextStage} className="inline-flex items-center gap-2 px-8 py-3 bg-stone-800 text-[#fff8e1] rounded-lg font-bold hover:bg-stone-900 transition-all shadow-md">
                      {currentStage < milestones.length - 1 ? "ç¹¼çºŒå‰é€²" : "æŸ¥çœ‹çµæœ"} <ArrowRight size={20} />
                    </button>
                  </div>
                ) : (
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {challenge.options.map((option, idx) => (
                      <button key={idx} onClick={() => handleOptionSelect(option)} className="text-left p-5 bg-white border-2 border-stone-200 rounded-xl hover:border-red-800 hover:bg-red-50 hover:shadow-md transition-all group relative overflow-hidden flex flex-col h-full">
                        <div className="flex gap-3">
                          <span className="flex-shrink-0 w-8 h-8 rounded-full bg-stone-100 text-stone-600 flex items-center justify-center font-bold text-sm group-hover:bg-red-100 group-hover:text-red-800 transition-colors border border-stone-300">
                            {String.fromCharCode(65 + idx)}
                          </span>
                          <span className="font-bold text-stone-800 text-base md:text-lg group-hover:text-red-800 leading-tight">
                            {option.label}
                          </span>
                        </div>
                      </button>
                    ))}
                  </div>
                )}
            </div>
          </div>
        )}

        {gameState === 'gameover' && (
          <div className="p-8 flex flex-col items-center text-center justify-center h-full space-y-6 bg-red-50">
              <div className="relative"><Skull size={80} className="text-red-700 animate-pulse" /></div>
              <h2 className="text-4xl font-black text-red-800 font-serif">é•·å¾å¤±æ•—</h2>
              <div className="bg-white p-6 rounded-xl shadow-sm border border-red-200 max-w-md">
                <p className="text-red-700 text-lg font-medium">
                  {food <= 0 ? "ç³§é£Ÿè€—ç›¡ï¼Œéƒ¨éšŠé£¢å¯’äº¤è¿«ï¼Œå€’åœ¨äº†é›ªå±±è‰åœ°ä¹‹ä¸­ã€‚" : "å£«æ°£å´©æ½°ï¼Œéƒ¨éšŠæ¸™æ•£ï¼Œåœ¨æ•µäººçš„åœè¿½å µæˆªä¸‹å¤±æ•—äº†ã€‚"}
                </p>
              </div>
              <button onClick={resetGame} className="flex items-center gap-2 px-8 py-3 bg-red-800 text-white font-bold rounded-xl hover:bg-red-900 transition-all shadow-lg mt-4">
                å†ä¾†ä¸€æ¬¡
              </button>
          </div>
        )}

        {gameState === 'result' && (
          <div className="p-8 flex flex-col items-center text-center justify-center h-full space-y-6 bg-amber-50">
              <div className="relative animate-bounce">
                <Trophy size={100} className="text-amber-500 drop-shadow-xl" />
                <Star size={40} className="text-red-600 absolute -top-4 -right-4 animate-spin-slow drop-shadow-md" fill="currentColor" />
              </div>
              <div>
                <h2 className="text-4xl font-black text-amber-700 mb-2 font-serif">é•·å¾å‹åˆ©ï¼</h2>
                <p className="text-amber-600 text-lg max-w-md mx-auto font-medium">ä½ å…‹æœäº†é‡é‡å›°é›£ï¼Œå¸¶é ˜ç´…è»åˆ°é”é™åŒ—ï¼</p>
              </div>
              <div className="bg-white p-8 rounded-xl shadow-xl border-4 border-amber-400 w-full max-w-sm relative overflow-hidden">
                <div className="text-xs text-stone-500 font-bold uppercase tracking-widest mb-2">ç²å¾—æ¦®è­½ç¨±è™Ÿ</div>
                <div className={`text-3xl font-black ${rank.color} flex items-center justify-center gap-2 mb-2 font-serif`}>
                  <Medal size={32} /> {rank.title}
                </div>
                <p className="text-sm text-stone-600 italic border-b border-orange-100 pb-4 mb-4">{rank.desc}</p>
                <div className="flex justify-between items-end">
                  <div className="text-left">
                    <div className="text-xs text-stone-500 font-bold uppercase">ç¸½å¾—åˆ†</div>
                    <div className="text-4xl font-black text-stone-800 leading-none">{totalScore}</div>
                  </div>
                  <div className="flex gap-4 text-sm font-bold text-stone-700">
                    <div className="flex flex-col items-center"><Wheat size={16} className="text-amber-500"/> <span>{food}</span></div>
                    <div className="flex flex-col items-center"><Heart size={16} className="text-red-600"/> <span>{morale}</span></div>
                  </div>
                </div>
              </div>
              <div className="flex gap-4 mt-2">
                <button onClick={onClose} className="px-6 py-2 border-2 border-stone-300 text-stone-600 font-bold rounded-lg hover:bg-stone-100 transition-all">è¿”å›åœ°åœ–</button>
                <button onClick={resetGame} className="flex items-center gap-2 px-6 py-2 bg-red-800 text-white font-bold rounded-lg hover:bg-red-900 transition-all shadow-md">å†ç©ä¸€æ¬¡</button>
              </div>
          </div>
        )}
      </div>
    </div>
  );
};

// LeafletMapView.tsx
const LeafletMapView = ({ currentStep, onNodeClick }) => {
  const mapRef = useRef(null);
  const mapInstanceRef = useRef(null);
  const markersRef = useRef([]);
  const polylineRef = useRef(null);

  useEffect(() => {
    if (!mapInstanceRef.current && mapRef.current) {
      const map = L.map(mapRef.current, {
        zoomControl: false,
        attributionControl: false
      }).setView(MILESTONES[0].coords, 6);

      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
      }).addTo(map);

      mapInstanceRef.current = map;

      const createIcon = (isActive, idx) => L.divIcon({
        className: 'custom-div-icon',
        html: `<div class="marker-pin ${isActive ? 'active' : ''}">${isActive ? 'â˜…' : idx + 1}</div>`,
        iconSize: [24, 24],
        iconAnchor: [12, 12]
      });

      const latlngs = MILESTONES.map(m => m.coords);
      polylineRef.current = L.polyline(latlngs, { color: '#b71c1c', weight: 4, dashArray: '5, 10', opacity: 0.7 }).addTo(map);

      MILESTONES.forEach((m, idx) => {
         const marker = L.marker(m.coords, { icon: createIcon(false, idx) })
           .addTo(map)
           .bindPopup(`<b>${m.title}</b><br>${m.date}`)
           .on('click', () => onNodeClick(idx));
         markersRef.current.push(marker);
      });
    }

    return () => {
    };
  }, []);

  useEffect(() => {
    const map = mapInstanceRef.current;
    if (map && markersRef.current.length > 0) {
      markersRef.current.forEach((marker, idx) => {
         const isActive = idx === currentStep;
         const iconHtml = `<div class="marker-pin ${isActive ? 'active' : ''}">${isActive ? 'â˜…' : idx + 1}</div>`;
         const newIcon = L.divIcon({
            className: 'custom-div-icon',
            html: iconHtml,
            iconSize: [24, 24],
            iconAnchor: [12, 12]
         });
         marker.setIcon(newIcon);
         
         if (isActive) {
           marker.openPopup();
         } else {
           marker.closePopup();
         }
      });

      map.flyTo(MILESTONES[currentStep].coords, 8, {
         animate: true,
         duration: 1.5
      });
    }
  }, [currentStep]);

  return (
     <div className="flex flex-col w-full h-full gap-2 p-2">
       <div id="map-container" className="relative flex-1 rounded-xl overflow-hidden shadow-inner border-4 border-[#8d6e63]">
          <div ref={mapRef} className="w-full h-full"></div>
          <div className="absolute top-4 right-4 z-[1000] bg-white/90 backdrop-blur px-3 py-1 rounded shadow border border-[#8d6e63] text-xs font-bold text-[#5d4037]">
             OpenStreetMap è¦–åœ–
          </div>
       </div>
       
       <div className="flex items-center gap-2 bg-[#e0f2f1] p-1 rounded-xl border border-[#8d6e63]">
          <button onClick={() => onNodeClick(Math.max(0, currentStep - 1))} disabled={currentStep === 0} className="p-2 rounded-full hover:bg-[#b2dfdb] disabled:opacity-30 text-[#00695c] transition-colors"><ChevronLeft size={20} /></button>
          <div className="h-16 bg-[#fff8e1] rounded-lg border border-[#d7ccc8] shadow-inner overflow-x-auto whitespace-nowrap p-2 flex items-center gap-4 flex-1 scroll-smooth no-scrollbar">
            {MILESTONES.map((m, idx) => {
              const isActive = idx === currentStep;
              return (
                <div key={idx} onClick={() => onNodeClick(idx)} className={`inline-flex flex-col items-center justify-center gap-1 cursor-pointer p-1 rounded-lg transition-all duration-300 min-w-[80px] group ${isActive ? 'scale-110 bg-[#f9fbe7]' : 'hover:bg-[#f9fbe7]/50'}`}>
                  <div className="relative flex items-center justify-center w-full h-5">
                     {idx > 0 && <div className={`absolute left-[-50%] right-[50%] h-0.5 top-2.5 -z-10 ${idx <= currentStep ? 'bg-[#b71c1c]' : 'bg-[#d7ccc8]'}`}></div>}
                     {idx < MILESTONES.length - 1 && <div className={`absolute left-[50%] right-[-50%] h-0.5 top-2.5 -z-10 ${idx < currentStep ? 'bg-[#b71c1c]' : 'bg-[#d7ccc8]'}`}></div>}
                     <div className={`w-3 h-3 rounded-full border-2 flex items-center justify-center transition-all ${isActive ? 'bg-[#b71c1c] border-[#ffd600] w-4 h-4 shadow-md' : (idx < currentStep ? 'bg-[#b71c1c] border-[#b71c1c]' : 'bg-[#efebe9] border-[#a1887f]')}`}>{isActive && <div className="w-1 h-1 bg-[#ffd600] rounded-full animate-pulse"></div>}</div>
                  </div>
                  <span className={`text-[10px] font-bold font-serif ${isActive ? 'text-[#b71c1c]' : 'text-[#5d4037] opacity-70'}`}>{m.title}</span>
                </div>
              );
            })}
          </div>
          <button onClick={() => onNodeClick(Math.min(MILESTONES.length - 1, currentStep + 1))} disabled={currentStep === MILESTONES.length - 1} className="p-2 rounded-full hover:bg-[#b2dfdb] disabled:opacity-30 text-[#00695c] transition-colors"><ChevronRight size={20} /></button>
       </div>
     </div>
  );
};

// App.tsx
const App = () => {
  const [currentStep, setCurrentStep] = useState(0);
  const [isQuizOpen, setIsQuizOpen] = useState(false);
  const [isGameOpen, setIsGameOpen] = useState(false);
  const [showIntro, setShowIntro] = useState(true);
  const [activeTab, setActiveTab] = useState('history');
  const contentRef = useRef(null);
  const currentData = MILESTONES[currentStep];

  useEffect(() => { 
    if (contentRef.current) contentRef.current.scrollTo({ top: 0, behavior: 'smooth' }); 
  }, [currentStep, activeTab]);

  const handleNext = () => { if (currentStep < MILESTONES.length - 1) { setCurrentStep(prev => prev + 1); setActiveTab('history'); } };
  const handlePrev = () => { if (currentStep > 0) { setCurrentStep(prev => prev - 1); setActiveTab('history'); } };

  return (
    <div className="flex flex-col h-screen bg-[#e8e4d9] text-[#2c2420] font-sans overflow-hidden selection:bg-red-200 selection:text-red-900">
      <header className="bg-gradient-to-r from-[#8b1c1c] to-[#a02626] text-[#fff8e1] px-4 py-3 shadow-xl flex justify-between items-center z-30 relative shrink-0 border-b-[3px] border-[#d4af37]">
        <div className="flex items-center gap-3">
          <div className="bg-[#d4af37] text-[#8b1c1c] p-2 rounded-lg shadow-inner border border-[#fdd835] ring-2 ring-[#8b1c1c]/50">
            <Star size={20} fill="currentColor" className="animate-pulse" />
          </div>
          <div>
            <h1 className="text-xl md:text-2xl font-bold tracking-[0.2em] leading-none font-serif text-[#fff8e1] drop-shadow-md">é•·å¾</h1>
            <p className="text-[10px] text-[#ffecb3] font-medium tracking-wide opacity-90 mt-1">äºŒè¬äº”åƒé‡Œäº¤äº’å¼æ•™å­¸åœ°åœ–</p>
          </div>
        </div>
        <div className="flex gap-3">
          <button onClick={() => setIsGameOpen(true)} className="group relative px-4 py-1.5 bg-[#fbc02d] hover:bg-[#ffeb3b] text-[#5d4037] rounded-full font-bold text-xs md:text-sm shadow-lg transition-all hover:-translate-y-0.5 border border-[#fdd835]">
            <span className="flex items-center gap-1.5 relative z-10"><Trophy size={14} /> ç”Ÿå­˜æŒ‘æˆ°</span>
            <div className="absolute inset-0 bg-white/20 rounded-full blur opacity-0 group-hover:opacity-100 transition-opacity"></div>
          </button>
          <button onClick={() => setShowIntro(true)} className="flex items-center gap-1.5 px-3 py-1.5 bg-black/20 hover:bg-black/30 rounded-full text-xs md:text-sm text-[#ffecb3] transition-colors border border-white/10">
            <Info size={14} /> æŒ‡å—
          </button>
        </div>
      </header>

      <div className="flex flex-1 flex-col md:flex-row overflow-hidden relative">
        <div className="w-full md:w-7/12 lg:w-2/3 h-[45vh] md:h-full relative z-0 bg-[#d7ccc8] shadow-[inset_-5px_0_15px_rgba(0,0,0,0.1)]">
           <LeafletMapView currentStep={currentStep} onNodeClick={(idx) => { setCurrentStep(idx); setActiveTab('history'); }} />
        </div>

        <div className="w-full md:w-5/12 lg:w-1/3 h-[55vh] md:h-full bg-[url('https://www.transparenttextures.com/patterns/cream-dust.png')] bg-[#fdfbf7] flex flex-col shadow-2xl z-20 border-l border-[#bcaaa4] relative">
          <div className="flex items-center justify-between p-3 bg-[#e6e2d3] border-b border-[#d7ccc8] shrink-0 shadow-sm relative z-20">
             <button onClick={handlePrev} disabled={currentStep === 0} className="flex items-center gap-1 pl-2 pr-3 py-2 rounded-lg text-[#5d4037] hover:bg-[#d7ccc8] disabled:opacity-30 disabled:cursor-not-allowed transition-all text-sm font-bold active:scale-95">
               <ChevronLeft size={18} /> ä¸Šä¸€ç«™
             </button>
             <div className="flex flex-col items-center">
               <div className="text-[9px] uppercase tracking-widest text-[#8d6e63] font-bold mb-0.5">ç•¶å‰é€²åº¦</div>
               <div className="bg-[#fff8e1] px-3 py-0.5 rounded border border-[#d7ccc8] shadow-inner flex items-center gap-1 text-sm font-bold font-mono text-[#3e2723]">
                 <span className="text-[#c62828] text-base">{currentStep + 1}</span><span className="text-[#bdbdbd]">/</span><span>{MILESTONES.length}</span>
               </div>
             </div>
             <button onClick={handleNext} disabled={currentStep === MILESTONES.length - 1} className="flex items-center gap-1 pl-3 pr-2 py-2 rounded-lg bg-[#b71c1c] text-[#fff8e1] hover:bg-[#c62828] disabled:bg-[#d7ccc8] disabled:text-[#a1887f] disabled:cursor-not-allowed transition-all shadow-md active:scale-95 text-sm font-bold">
               ä¸‹ä¸€ç«™ <ChevronRight size={18} />
             </button>
          </div>

          <div ref={contentRef} className="flex-1 overflow-y-auto scroll-smooth relative pb-24">
            <div className="px-6 pt-6 pb-2">
               <div className="flex items-center justify-between mb-3">
                 <div className="inline-flex items-center gap-1.5 px-2.5 py-1 rounded bg-[#efebe9] text-[#5d4037] border border-[#d7ccc8] text-xs font-bold uppercase tracking-wider shadow-sm">
                   <MapPin size={12} className="text-[#c62828]" /> {currentData.location}
                 </div>
                 <div className="text-xs text-[#8d6e63] font-serif font-bold tracking-wide italic border-b border-[#d7ccc8]">{currentData.date}</div>
               </div>
               <h2 className="text-3xl md:text-4xl font-black text-[#3e2723] leading-tight tracking-tight font-serif mb-4 drop-shadow-sm">{currentData.title}</h2>
               <div className="inline-flex items-center gap-3 bg-white/60 px-3 py-1.5 rounded-r-xl border-l-4 border-[#ffb300] shadow-sm mb-2 backdrop-blur-sm">
                 <div className={`p-1.5 rounded-full ${currentData.stat.icon === 'users' ? 'bg-blue-100 text-blue-800' : 'bg-amber-100 text-amber-800'}`}>
                   {currentData.stat.icon === 'users' ? <Users size={14}/> : <Info size={14} />}
                 </div>
                 <div className="flex flex-col leading-none">
                   <span className="text-[9px] text-[#8d6e63] font-bold uppercase mb-0.5">{currentData.stat.label}</span>
                   <span className="text-sm font-bold text-[#3e2723]">{currentData.stat.value}</span>
                 </div>
               </div>
            </div>

            <div className="sticky top-0 z-20 bg-[#fdfbf7]/95 backdrop-blur-sm px-6 pt-2 pb-0 shadow-sm border-b border-[#d7ccc8]">
                <div className="flex items-end gap-1">
                   {[
                     { id: 'history', label: 'æ­·å²', icon: BookOpen },
                     { id: 'figures', label: 'äººç‰©', icon: Users },
                     { id: 'survival', label: 'é»æ»´', icon: ScrollText }
                   ].map((tab) => (
                      <button key={tab.id} onClick={() => setActiveTab(tab.id)} className={`flex-1 flex items-center justify-center gap-2 py-2.5 rounded-t-lg text-xs md:text-sm font-bold transition-all duration-200 border-t border-x relative top-[1px] ${activeTab === tab.id ? 'bg-white border-[#d7ccc8] text-[#b71c1c] shadow-[0_-2px_5px_rgba(0,0,0,0.05)] z-10' : 'bg-[#f5f5f5] border-transparent text-[#9e9e9e] hover:bg-[#eeeeee] hover:text-[#757575]'}`}>
                         <tab.icon size={14} /> {tab.label}
                      </button>
                   ))}
                </div>
            </div>

            <div className="p-6 bg-white min-h-[400px] animate-fade-in-zoom">
                  {activeTab === 'history' && (
                    <div className="space-y-6">
                      <EventSchematic id={currentData.id} />
                      <div className="relative pl-4 border-l-2 border-[#ffb300]">
                        <h3 className="text-lg font-bold text-[#3e2723] mb-2 font-serif">äº‹ä»¶ç¶“é</h3>
                        <p className="text-[#5d4037] leading-relaxed text-justify text-sm md:text-base">{currentData.description}</p>
                      </div>
                      <div className="bg-[#fffde7] p-5 rounded-xl border border-[#fff59d] shadow-sm relative overflow-hidden">
                        <Star className="absolute -right-2 -top-2 text-[#fff176] opacity-50" size={60} />
                        <h3 className="flex items-center gap-2 font-bold text-[#c62828] text-base mb-2 font-serif relative z-10">
                          <Flag size={16} /> æ­·å²æ„ç¾©
                        </h3>
                        <p className="text-[#4e342e] leading-relaxed text-justify text-sm font-medium relative z-10">{currentData.significance}</p>
                      </div>
                    </div>
                  )}

                  {activeTab === 'figures' && (
                    <div className="space-y-4">
                      <div className="bg-[#e3f2fd] p-4 rounded-xl border border-[#bbdefb] text-sm text-[#1565c0] flex gap-3 shadow-sm">
                        <Info size={18} className="shrink-0 mt-0.5" />
                        <p>æ­·å²æ˜¯ç”±äººæ°‘å‰µé€ çš„ï¼Œä½†è‹±é›„äººç‰©åœ¨é—œéµæ™‚åˆ»çš„æŠ‰æ“‡å¾€å¾€æ±ºå®šäº†æ­·å²çš„èµ°å‘ã€‚</p>
                      </div>
                      <div className="grid gap-4">
                        {currentData.figures.map((person, idx) => (
                          <div key={idx} className="bg-white p-5 rounded-xl border border-[#e0e0e0] shadow-sm hover:shadow-md hover:border-[#b0bec5] transition-all flex flex-col gap-2 group">
                            <div className="flex items-center justify-between">
                              <div className="flex items-center gap-3">
                                <div className="w-10 h-10 rounded-full bg-[#eceff1] flex items-center justify-center text-[#546e7a] font-serif font-bold text-lg border border-[#cfd8dc] group-hover:bg-[#37474f] group-hover:text-white transition-colors">
                                  {person.name.charAt(0)}
                                </div>
                                <h3 className="font-bold text-lg text-[#37474f]">{person.name}</h3>
                              </div>
                              <span className="text-[10px] font-bold bg-[#eceff1] text-[#455a64] px-2 py-1 rounded shadow-sm">{person.role}</span>
                            </div>
                            <p className="text-[#546e7a] text-sm leading-relaxed pl-[3.25rem]">{person.desc}</p>
                          </div>
                        ))}
                      </div>
                    </div>
                  )}

                  {activeTab === 'survival' && (
                    <div className="space-y-6">
                      <div className="bg-[#3e2723] rounded-xl shadow-lg border border-[#5d4037] overflow-hidden text-[#efebe9]">
                        <div className="bg-gradient-to-r from-[#5d4037] to-[#4e342e] p-5 relative border-b border-[#6d4c41]">
                          <div className="flex items-center gap-2 text-[#ffb74d] mb-1 opacity-90">
                            <Tent size={16} />
                            <span className="text-xs font-bold uppercase tracking-widest">è¡Œè»è¦‹è</span>
                          </div>
                          <h3 className="font-serif text-2xl font-bold tracking-wide">{currentData.survival.title}</h3>
                          <Flame className="absolute right-4 bottom-[-10px] text-[#ffcc80] opacity-10 w-24 h-24 rotate-12" />
                        </div>
                        <div className="p-6 bg-[url('https://www.transparenttextures.com/patterns/dark-leather.png')]">
                          <p className="text-[#d7ccc8] text-base leading-loose font-serif first-letter:text-3xl first-letter:font-bold first-letter:text-[#ffb74d] first-letter:mr-1">
                            {currentData.survival.content}
                          </p>
                        </div>
                      </div>

                      {currentData.survival.poem && (
                        <div className="bg-stone-50 p-6 rounded-xl border border-stone-200 shadow-sm relative overflow-hidden group hover:border-stone-300 transition-colors">
                          <div className="absolute top-3 right-4 text-stone-200 group-hover:text-stone-300 transition-colors">
                            <Music size={40} />
                          </div>
                          <div className="relative z-10">
                            <div className="flex items-center gap-2 mb-3">
                              <span className="bg-stone-200 text-stone-600 text-[10px] px-2 py-0.5 rounded font-bold uppercase">
                                {currentData.survival.poem.source || 'è©©è©'}
                              </span>
                            </div>
                            <p className="text-lg font-serif font-bold text-stone-800 leading-relaxed mb-2 whitespace-pre-wrap">
                              {currentData.survival.poem.text}
                            </p>
                            {currentData.survival.poem.author && (
                              <p className="text-right text-sm text-stone-500 font-serif italic">
                                â€”â€” {currentData.survival.poem.author}
                              </p>
                            )}
                          </div>
                        </div>
                      )}
                    </div>
                  )}
            </div>
          </div>

          <div className="absolute bottom-0 left-0 right-0 p-4 pt-8 bg-gradient-to-t from-white via-white to-transparent z-30 pointer-events-none flex justify-center">
             <button onClick={() => setIsQuizOpen(true)} className="pointer-events-auto w-full max-w-sm py-3 bg-gradient-to-r from-[#ffa000] to-[#ff6f00] hover:from-[#ffb300] hover:to-[#ff8f00] text-[#3e2723] font-bold rounded-xl shadow-[0_4px_10px_rgba(255,111,0,0.3)] hover:shadow-[0_6px_15px_rgba(255,111,0,0.4)] transform hover:-translate-y-1 active:translate-y-0 transition-all flex items-center justify-center gap-2 border border-[#ffe082]">
               <HelpCircle size={20} /> <span>éš¨å ‚çŸ¥è­˜å•ç­”</span>
             </button>
          </div>
        </div>
      </div>

      <QuizModal quizzes={currentData.quizzes} isOpen={isQuizOpen} onClose={() => setIsQuizOpen(false)} />
      <SurvivalGameModal milestones={MILESTONES} isOpen={isGameOpen} onClose={() => setIsGameOpen(false)} />

      {showIntro && (
        <div className="fixed inset-0 bg-[#263238]/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fade-in-zoom">
          <div className="bg-[#fdfbf7] rounded-xl max-w-2xl w-full shadow-2xl overflow-hidden border-4 border-[#3e2723] flex flex-col max-h-[90vh] relative">
            <div className="absolute top-4 right-4 border-2 border-[#c62828] text-[#c62828] rounded px-2 py-1 text-xs font-bold uppercase -rotate-12 opacity-80 mix-blend-multiply pointer-events-none">TOP SECRET</div>
            <div className="bg-[#8b1c1c] p-6 text-[#fff8e1] flex justify-between items-start shrink-0 relative overflow-hidden shadow-md">
              <div className="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
              <div className="relative z-10">
                <h2 className="text-3xl font-bold mb-1 tracking-widest font-serif">é•·å¾æª”æ¡ˆ</h2>
                <p className="text-[#ffcdd2] text-sm font-medium tracking-wide">äº’å‹•å¼æ­·å²æ•™å­¸è¼”åŠ©ç³»çµ±</p>
              </div>
              <button onClick={() => setShowIntro(false)} className="relative z-10 text-[#ffcdd2] hover:text-white transition-colors bg-white/10 hover:bg-white/20 p-2 rounded-full">
                <X size={20} />
              </button>
            </div>
            <div className="p-8 space-y-6 overflow-y-auto bg-[url('https://www.transparenttextures.com/patterns/cream-dust.png')]">
              <p className="text-[#4e342e] text-lg font-serif italic text-center border-b border-[#d7ccc8] pb-4">"ç´…è»ä¸æ€•é å¾é›£ï¼Œè¬æ°´åƒå±±åªç­‰é–’ã€‚"</p>
              <div className="grid md:grid-cols-3 gap-4">
                <div className="bg-white p-4 rounded-lg border border-[#d7ccc8] shadow-sm hover:border-[#bcaaa4] transition-all text-center">
                  <BookOpen size={28} className="mx-auto mb-2 text-[#8b1c1c]" />
                  <h3 className="font-bold text-[#3e2723] mb-1">å¤šç¶­æ•˜äº‹</h3>
                  <p className="text-xs text-[#5d4037]">æˆ°ç•¥åœ°åœ– x æˆ°è¡“åœ–è§£</p>
                </div>
                <div className="bg-white p-4 rounded-lg border border-[#d7ccc8] shadow-sm hover:border-[#bcaaa4] transition-all text-center">
                  <Users size={28} className="mx-auto mb-2 text-[#0d47a1]" />
                  <h3 className="font-bold text-[#3e2723] mb-1">äººç‰©èšç„¦</h3>
                  <p className="text-xs text-[#5d4037]">é‚„åŸé®®æ´»æ­·å²ç¾¤åƒ</p>
                </div>
                <div className="bg-white p-4 rounded-lg border border-[#d7ccc8] shadow-sm hover:border-[#bcaaa4] transition-all text-center">
                  <Tent size={28} className="mx-auto mb-2 text-[#f57f17]" />
                  <h3 className="font-bold text-[#3e2723] mb-1">ç”Ÿå­˜é«”é©—</h3>
                  <p className="text-xs text-[#5d4037]">æ•¸æ“šæ¨¡æ“¬è¡Œè»æŒ‘æˆ°</p>
                </div>
              </div>
              <div className="group bg-[#fff8e1] p-5 rounded-xl border border-[#ffe082] flex items-center gap-4 cursor-pointer hover:shadow-md transition-all relative overflow-hidden" onClick={() => {setShowIntro(false); setIsGameOpen(true);}}>
                <div className="bg-[#fbc02d] text-[#3e2723] p-3 rounded-full shrink-0 shadow-sm group-hover:scale-110 transition-transform z-10">
                  <Trophy size={24} />
                </div>
                <div className="flex-1 z-10">
                  <div className="flex items-center gap-2 mb-1">
                    <h4 className="font-bold text-[#3e2723] text-lg">æŒ‘æˆ°æ¨¡å¼ï¼šçªåœ</h4>
                    <span className="bg-[#c62828] text-white text-[10px] px-1.5 py-0.5 rounded font-bold">HARD</span>
                  </div>
                  <p className="text-xs text-[#5d4037]">æ‰®æ¼”æŒ‡æ®å®˜ï¼Œåœ¨è³‡æºåŒ±ä¹ä¸­åšå‡ºè‰±é›£æŠ‰æ“‡ã€‚èƒ½å¦å¸¶é ˜éƒ¨éšŠåˆ°é”é™åŒ—ï¼Ÿ</p>
                </div>
                <ChevronRight className="text-[#fbc02d] group-hover:translate-x-1 transition-transform z-10" />
              </div>
            </div>
            <div className="p-6 bg-[#efebe9] border-t border-[#d7ccc8] shrink-0">
              <button onClick={() => setShowIntro(false)} className="w-full py-3.5 bg-[#3e2723] text-[#fff8e1] font-bold rounded-lg hover:bg-[#4e342e] transition-all shadow-lg transform active:scale-[0.99] flex items-center justify-center gap-2 text-base tracking-wider">
                é–‹å•Ÿæª”æ¡ˆ <ChevronRight size={16} />
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

// --- Index ---
const rootElement = document.getElementById('root');
if (!rootElement) {
  throw new Error("Could not find root element to mount to");
}

const root = createRoot(rootElement);
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
    </script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>